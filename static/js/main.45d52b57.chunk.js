(this["webpackJsonpmsfs-map"]=this["webpackJsonpmsfs-map"]||[]).push([[0],{118:function(e,t,a){e.exports={plane:"MapContent_plane__1IguB"}},119:function(e){e.exports=JSON.parse('{"a":"0.5.0"}')},120:function(e,t,a){e.exports={map:"Map_map__aNmAM"}},121:function(e,t,a){e.exports={sidebar:"Sidebar_sidebar__1kXOI"}},132:function(e,t,a){},14:function(e,t,a){e.exports={player:"TtsPlayer_player__1JS2S",image:"TtsPlayer_image__3X_de",controls:"TtsPlayer_controls__36NAB",info:"TtsPlayer_info__nurS5",next:"TtsPlayer_next__1JZmy"}},20:function(e,t,a){e.exports={main:"Preferences_main__ok2ws",preference:"Preferences_preference__191Je",preferenceButton:"Preferences_preferenceButton__FdKIq",expanded:"Preferences_expanded__Gn5Np",caret:"Preferences_caret__WiQ2N"}},215:function(e,t,a){},233:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),r=a(16),c=a.n(r),o=(a(132),a(106)),s=a(3),l=a(4),u=a(9),d=a(82),p=a.n(d),b=a(17),j=Object(b.b)({name:"simdata",initialState:{position:void 0,altitude:0,heading:0,airspeed:0,vertical_speed:0,airspeed_true:0,flaps:0,trim:0,rudder_trim:0},reducers:{updateData:function(e,t){var a=t.payload;e.position&&e.position[0]===a.latitude&&e.position[1]===a.longitude||(e.position=[a.latitude,a.longitude]),e.altitude=a.altitude,e.heading=a.heading,e.airspeed=a.airspeed,e.vertical_speed=a.vertical_speed,e.airspeed_true=a.airspeed_true,e.flaps=a.flaps,e.trim=a.trim,e.rudder_trim=a.rudder_trim}}}),v=j.actions.updateData,g=function(e){return e.simdata},f=j.reducer,m=a(2),h=n.memo((function(e){var t=e.airspeed,a=e.airspeed_true,n=e.altitude,i=e.heading,r=e.vertical_speed,c=e.flaps,o=e.trim,s=e.rudder_trim;return Object(m.jsxs)("div",{className:p.a.main,children:[Object(m.jsx)(O,{label:"Airspeed",value:"".concat(t," kt (").concat(a," kt)")}),Object(m.jsx)(O,{label:"Altitude",value:"".concat(n," ft")}),Object(m.jsx)(O,{label:"Heading",value:Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(u.e,{style:{transform:"rotate(".concat(i-90,"deg)")}})," ".concat(i,"\xb0")]})}),Object(m.jsx)(O,{label:"V. speed",value:"".concat(r," ft/s")}),0!==parseFloat(c)&&Object(m.jsx)(O,{label:"Flaps",value:"".concat(c)}),0!==parseFloat(o)&&Object(m.jsx)(O,{label:"Trim",value:"".concat(o,"%")}),0!==parseFloat(s)&&Object(m.jsx)(O,{label:"R.Trim",value:"".concat(s,"%")})]})}));function O(e){var t=e.label,a=e.value;e.unit;return Object(m.jsxs)("span",{className:p.a.infoField,children:[Object(m.jsx)("label",{children:t}),Object(m.jsx)("span",{children:a})]})}function x(){var e=Object(l.d)(g);return Object(m.jsx)(h,Object(s.a)({},e))}var k=a(13),y=a(84),_=a(19),w=a.n(_),S=a(38),P=a(66),N=a(36),z=a(37),M=function(){function e(){Object(N.a)(this,e)}return Object(z.a)(e,[{key:"getWikipediaApiUrl",value:function(e,t){var a=Object.keys(t).reduce((function(e,a){return e&&(e+="&"),"".concat(e).concat(encodeURIComponent(a),"=").concat(encodeURIComponent(t[a]))}),"");return"https://".concat(e,".wikipedia.org/w/api.php?").concat(a)}},{key:"getPagesByGeoLocation",value:function(){var e=Object(S.a)(w.a.mark((function e(t,a,n,i){var r,c,o,s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={format:"json",action:"query",generator:"geosearch",ggslimit:20,ggsradius:i,ggscoord:a+"|"+n,origin:"*",prop:"extracts|pageimages|coordinates",exsentences:"10",exintro:!0,exlimit:20,pithumbsize:"400",imlimit:"10"},c=this.getWikipediaApiUrl(t,r),e.next=4,fetch(c);case 4:return o=e.sent,e.next=7,o.json();case 7:return s=e.sent,e.abrupt("return",s);case 9:case"end":return e.stop()}}),e,this)})));return function(t,a,n,i){return e.apply(this,arguments)}}()}]),e}(),E=new M,F=function(){function e(t,a){Object(N.a)(this,e),this.api=t,this.storage=a}return Object(z.a)(e,[{key:"getPagesByGeoLocation",value:function(){var e=Object(S.a)(w.a.mark((function e(t,a,n,i){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.getPagesByGeoLocation(t,a,n,i);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,a,n,i){return e.apply(this,arguments)}}()}]),e}(),R=new F(E,window.localStorage),C=["en","ceb","sv","de","fr","nl","ru","it","es","pl","war","vi","ja","zh","arz","ar","uk","pt","fa","ca","sr","id","no","ko","fi","hu","cs","sh","ro","zh-min-nan","tr","eu","ms","ce","eo","he","hy","bg","da","azb","sk","kk","min","hr","et","lt","be","el","simple","az","sl","gl","ur","nn","tt","hi","ka","th","uz","la","cy","ta","vo","mk","ast","lv","zh-yue","tg","bn","af","mg","oc","bs","sq","ky","nds","new","be-tarask","ml","te","br","tl","vec","pms","mr","su","ht","sw","lb","jv","pnb","ba","ga","szl","is","my","sco","fy","cv","lmo","wuu","an","pa","ne","diq","ku","yo","bar","io","gu","ckb","als","kn","scn","bpy","qu","ia","mn","bat-smg","si","nv","or","cdo","ilo","gd","xmf","yi","am","nap","bug","wa","sd","hsb","mai","fo","map-bms","mzn","li","sah","eml","os","ps","sa","frr","bcl","zh-classical","ace","mrj","mhr","avk","hif","gor","hak","roa-tara","pam","hyw","km","nso","rue","crh","se","bh","as","shn","vls","mi","nds-nl","nah","sc","vep","gan","myv","sn","ab","glk","bo","lrc","co","so","tk","fiu-vro","csb","ha","kv","ie","gv","udm","pcd","ay","kab","zea","sat","nrm","ug","lij","zu","kw","frp","lez","ban","stq","lfn","gn","mwl","gom","rm","mt","lo","lad","koi","fur","olo","ang","dty","dsb","bjn","ext","ln","cbk-zam","dv","ksh","tyv","ary","gag","pfl","pag","pi","av","awa","haw","bxr","xal","krc","pap","za","pdc","rw","kaa","szy","arc","to","nov","jam","tpi","kbp","kbd","ig","inh","na","tet","wo","tcy","ki","atj","jbo","roa-rup","bi","lbe","kg","ty","lg","mdf","fj","srn","xh","gcr","ltg","lld","chr","ak","om","sm","kl","got","pih","st","cu","ny","nqo","tn","tw","ts","rmy","bm","mnw","chy","rn","tum","ss","ch","iu","pnt","ks","ady","ve","ee","ik","ff","sg","dz","ti","cr","din","ng","cho","kj","mh","ho","ii","aa","mus","hz","kr"],V=a(27),I=a(65);function B(e){return 0===e||e?e<1e3?"".concat(Math.round(e)," m"):"".concat(e<99999?(e/1e3).toFixed(1):Math.round(e/1e3)," km"):""}var W=Object(b.b)({name:"wikipedia",initialState:{edition:"en",isEnabled:!0,availableEditions:C,pages:[],pagesViewed:[],playQueue:[],lastSearchPosition:void 0,lastSearchRadius:void 0,lastSearchTime:void 0,searchRadius:1e4},reducers:{setEnabled:function(e,t){t.payload?e.isEnabled=!0:(e.isEnabled=!1,e.pages=[])},receivePages:function(e,t){var a,n=t.payload,i=n.data,r=(i=void 0===i?{}:i).query,c=(r=void 0===r?{}:r).pages,o=n.searchPosition,s=n.searchRadius,l=n.searchTime;if(c){var u=Object.keys(c).reduce((function(e,t){return e.push(c[t]),e}),[]).filter((function(t){return!e.pages.some((function(e){return t.pageid===e.pageid}))&&!e.pagesViewed.some((function(e){return t.pageid===e}))&&t.coordinates}));(a=e.pages).push.apply(a,Object(P.a)(u)),e.lastSearchPosition=o,e.lastSearchRadius=s,e.lastSearchTime=l}},removePages:function(e,t){var a=t.payload.pageids;e.pages=e.pages.filter((function(e){return!a.includes(e.pageid)}))},addToPlayQueue:function(e,t){var a=t.payload.pageid;e.playQueue.push(a)},advancePlayQueue:function(e){var t=e.playQueue.shift();e.pages=e.pages.filter((function(e){return e.pageid!==t})),e.pagesViewed.push(t)},markAsRead:function(e,t){var a=t.payload.pageid;e.pages=e.pages.filter((function(e){return e.pageid!==a})),e.pagesViewed.push(a)},setEdition:function(e,t){var a=t.payload;e.edition=a,e.pages=[],e.pagesViewed=[],e.playQueue=[],e.lastSearchPosition=void 0,e.lastSearchRadius=void 0,e.lastSearchTime=void 0},setSearchRadius:function(e,t){e.searchRadius=parseInt(t.payload,10)}}}),T=W.actions,A=T.setEnabled,Q=T.setEdition,D=T.receivePages,J=T.removePages,q=T.addToPlayQueue,L=T.advancePlayQueue,G=T.markAsRead,U=T.setSearchRadius,H=(T.updatePageRatings,function(e,t,a){return function(){var n=Object(S.a)(w.a.mark((function n(i,r){var c,o,s;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=r(),o=Z(c),n.next=4,R.getPagesByGeoLocation(o,e,t,a);case 4:(s=n.sent)&&i(D({data:s,searchPosition:[e,t],searchRadius:a,searchTime:(new Date).getTime()}));case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}),X=function(e){return e.wikipedia.isEnabled},Z=function(e){return e.wikipedia.edition},K=function(e){return e.wikipedia.availableEditions},$=function(e){return e.wikipedia.searchRadius},Y=function(e){return e.wikipedia.lastSearchPosition},ee=function(e){return e.wikipedia.lastSearchRadius},te=function(e){return e.wikipedia.lastSearchTime},ae=Object(V.a)((function(e){var t,a,n,i;return{position:null===(t=e.simdata)||void 0===t?void 0:t.position,heading:null===(a=e.simdata)||void 0===a?void 0:a.heading,pages:null===(n=e.wikipedia)||void 0===n?void 0:n.pages,playQueue:null===(i=e.wikipedia)||void 0===i?void 0:i.playQueue}}),(function(e){var t=e.position,a=e.heading,n=e.pages,i=e.playQueue,r=t?{latitude:t[0],longitude:t[1]}:void 0,c=null===n||void 0===n?void 0:n.map((function(e){var t,n=null===(t=e.coordinates)||void 0===t?void 0:t.map((function(e){var t=r&&Object(I.getDistance)(r,{latitude:null===e||void 0===e?void 0:e.lat,longitude:null===e||void 0===e?void 0:e.lon}),n=r&&Math.round(Object(I.getRhumbLineBearing)(r,{latitude:null===e||void 0===e?void 0:e.lat,longitude:null===e||void 0===e?void 0:e.lon})),i=(((null!==n&&void 0!==n?n:0)-(null!==a&&void 0!==a?a:0))%360+540)%360-180;return{coord:e,distance:t,bearing:n,headingDifference:i,isInFront:i>=-90&&i<=90}})).sort((function(e,t){return e.distance-t.distance}))[0];return Object(s.a)(Object(s.a)({},e),{},{closestPoint:n,isInPlayQueue:i.includes(e.pageid)})})).sort((function(e,t){var a,n;return(null===(a=e.closestPoint)||void 0===a?void 0:a.distance)-(null===(n=t.closestPoint)||void 0===n?void 0:n.distance)}));return[].concat(Object(P.a)(c.filter((function(e){var t;return null===(t=e.closestPoint)||void 0===t?void 0:t.isInFront}))),Object(P.a)(c.filter((function(e){var t;return!(null===(t=e.closestPoint)||void 0===t?void 0:t.isInFront)}))))})),ne=function(e){var t=ae(e);return e.wikipedia.playQueue.map((function(e){return t.find((function(t){return t.pageid===e}))}))},ie=Object(V.a)((function(e){var t,a,n;return{position:null===(t=e.simdata)||void 0===t?void 0:t.position,heading:null===(a=e.simdata)||void 0===a?void 0:a.heading,searchRadius:null===(n=e.wikipedia)||void 0===n?void 0:n.searchRadius}}),(function(e){var t,a,n=e.position,i=e.heading,r=e.searchRadius;return Object(I.computeDestinationPoint)({latitude:null!==(t=null===n||void 0===n?void 0:n[0])&&void 0!==t?t:0,longitude:null!==(a=null===n||void 0===n?void 0:n[1])&&void 0!==a?a:0},r,i)})),re=W.reducer,ce=Object(b.b)({name:"tts",initialState:{currentVoice:void 0,availableVoices:[],isPlaying:!0},reducers:{setVoice:function(e,t){var a=t.payload;e.currentVoice=a},setAvailableVoices:function(e,t){var a=t.payload;e.availableVoices=a,e.voice&&!e.availableVoices.some((function(t){return t===e.voice}))&&(e.voice=void 0)},setIsPlaying:function(e,t){e.isPlaying=t.payload}}}),oe=ce.actions,se=oe.setVoice,le=oe.setAvailableVoices,ue=oe.setIsPlaying,de=function(e){return e.tts.currentVoice},pe=function(e){return e.tts.availableVoices},be=function(e){return e.tts.isPlaying},je=ce.reducer,ve=a(20),ge=a.n(ve),fe=[{name:"OpenStreetMap",type:"tileServer",tileServer:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors'},{name:"Stamen toner",type:"tileServer",tileServer:"http://{s}.tile.stamen.com/toner/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank\' href="http://maps.stamen.com">Stamen</a>'},{name:"Stamen terrain",type:"tileServer",tileServer:"http://{s}.tile.stamen.com/terrain/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank\' href="http://maps.stamen.com">Stamen</a>'},{name:"Stamen watercolor",type:"tileServer",tileServer:"http://{s}.tile.stamen.com/watercolor/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank\' href="http://maps.stamen.com">Stamen</a>'},{name:"Carto Dark",type:"tileServer",tileServer:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank\' href="https://carto.com">Carto</a>'},{name:"Carto (voyager)",type:"tileServer",tileServer:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",attribution:'&copy; <a target="_blank" href="https://osm.org/copyright">OpenStreetMap</a> <a target="_blank" href="https://carto.com/">Carto</a>',subdomains:"abcd"},{name:"Airspace data (OpenAIP)",type:"tileServer",tileServer:"https://{s}.tile.maps.openaip.net/geowebcache/service/tms/1.0.0/openaip_basemap@EPSG%3A900913@png/{z}/{x}/{y}.png",attribution:'"Airspace data: <a target="_blank" href="https://www.openaip.net/">OpenAIP</a>',subdomains:"12"}],me=Object(b.b)({name:"map",initialState:{isFollowing:!0,currentMap:"OpenStreetMap",availableMaps:fe},reducers:{setCurrentMap:function(e,t){e.currentMap=t.payload},setIsFollowing:function(e,t){e.isFollowing=t.payload}}}),he=me.actions,Oe=(he.updateMsfs,he.setCurrentMap),xe=he.setIsFollowing,ke=function(e){return e.map.availableMaps.find((function(t){return t.name===e.map.currentMap}))},ye=function(e){return e.map.availableMaps},_e=function(e){return e.map.isFollowing},we=me.reducer,Se=n.memo((function(e){var t=e.expanded,a=e.toggleExpanded,n=e.changeMap,i=e.currentMap,r=e.availableMaps,c=e.changeEdition,o=e.edition,s=e.availableEditions,l=e.changeSearchRadius,d=e.searchRadius,p=e.changeVoice,b=e.voice,j=e.availableVoices;return Object(m.jsxs)("div",{className:ge.a.main,children:[Object(m.jsxs)("button",{className:"".concat(ge.a.preferenceButton).concat(t?" ".concat(ge.a.expanded):""),onClick:a,children:[Object(m.jsx)(u.c,{size:"100%"}),Object(m.jsx)(u.b,{className:ge.a.caret})]}),t&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:ge.a.preference,children:[Object(m.jsx)("label",{htmlFor:"mapserver",children:"Map"}),Object(m.jsx)("select",{id:"mapserver",onChange:n,value:i.name,children:r.map((function(e){var t=e.name;return Object(m.jsx)("option",{value:t,children:t},t)}))})]}),Object(m.jsxs)("div",{className:ge.a.preference,children:[Object(m.jsx)("label",{htmlFor:"wikipedia-edition",children:"Wikipedia Edition"}),Object(m.jsx)("select",{id:"wikipedia-edition",onChange:c,value:o,children:s.map((function(e){return Object(m.jsx)("option",{value:e,children:y.a.getName(e)?"".concat(y.a.getName(e)," (").concat(e,")"):e},e)}))})]}),Object(m.jsxs)("div",{className:ge.a.preference,children:[Object(m.jsx)("label",{htmlFor:"searchRadius",children:"Wikipedia search radius"}),Object(m.jsx)("select",{id:"searchRadius",onChange:l,value:d,children:[5e3,1e4,2e4,5e4,1e5].map((function(e){return Object(m.jsx)("option",{value:e,children:"".concat(e/1e3," km")},e)}))})]}),Object(m.jsxs)("div",{className:ge.a.preference,children:[Object(m.jsx)("label",{htmlFor:"voice",children:"Voice"}),Object(m.jsx)("select",{id:"voice",onChange:p,value:b,children:j.map((function(e){return Object(m.jsx)("option",{value:e,children:e},e)}))})]})]})]})}));function Pe(){var e=Object(l.c)(),t=Object(n.useState)(!1),a=Object(k.a)(t,2),i=a[0],r=a[1],c=Object(l.d)(Z),o=Object(l.d)(K),s=Object(l.d)(de),u=Object(l.d)(pe),d=Object(l.d)(ke),p=Object(l.d)(ye),b=Object(l.d)($);Object(n.useEffect)((function(){Object(l.b)((function(){localStorage["wikipedia-enabled"]&&e(A(JSON.parse(localStorage["wikipedia-enabled"]))),localStorage["wikipedia-edition"]&&e(Q(localStorage["wikipedia-edition"])),localStorage.voice&&e(se(localStorage.voice)),localStorage.currentMap&&e(Oe(localStorage.currentMap)),localStorage.searchRadius&&e(U(localStorage.searchRadius))}))}),[e]);var j=Object(n.useCallback)((function(t){localStorage["wikipedia-edition"]=t.target.value,e(Q(t.target.value))}),[e]),v=Object(n.useCallback)((function(t){localStorage.voice=t.target.value,e(se(t.target.value))}),[e]),g=Object(n.useCallback)((function(t){localStorage.currentMap=t.target.value,e(Oe(t.target.value))}),[e]),f=Object(n.useCallback)((function(t){localStorage.searchRadius=t.target.value,e(U(t.target.value))}),[e]),h=Object(n.useCallback)((function(e){r(!i)}),[i]);return Object(n.useEffect)((function(){var t=function(){var t=window.speechSynthesis.getVoices();e(le(t.map((function(e){return e.name}))))};return t(),window.speechSynthesis.addEventListener("voiceschanged",t),function(){return window.speechSynthesis.removeEventListener("voiceschanged",t)}}),[e]),Object(m.jsx)(Se,{expanded:i,toggleExpanded:h,changeMap:g,currentMap:d,availableMaps:p,changeEdition:j,edition:c,availableEditions:o,changeSearchRadius:f,searchRadius:b,changeVoice:v,voice:s,availableVoices:u})}var Ne=a(116),ze=a(47),Me=a.n(ze),Ee=n.memo((function(e){var t=e.isFollowing,a=e.toggleFollow,n=e.isWikipediaEnabled,i=e.toggleIsEnabled;return Object(m.jsxs)("div",{className:Me.a.main,children:[Object(m.jsx)("button",{className:"".concat(t?Me.a.active:""),onClick:a,children:Object(m.jsx)(Ne.a,{size:"100%"})}),Object(m.jsx)("button",{className:"".concat(Me.a.gap," ").concat(n?Me.a.active:""),onClick:i,children:Object(m.jsx)(u.h,{size:"100%"})})]})}));function Fe(){var e=Object(l.c)(),t=Object(l.d)(_e),a=Object(n.useCallback)((function(){e(xe(!t))}),[e,t]),i=Object(l.d)(X),r=Object(n.useCallback)((function(){localStorage["wikipedia-enabled"]=JSON.stringify(!i),e(A(!i))}),[e,i]);return Object(m.jsx)(Ee,{isFollowing:t,toggleFollow:a,isWikipediaEnabled:i,toggleIsEnabled:r})}function Re(){return Object(m.jsxs)("div",{children:[Object(m.jsx)(x,{}),Object(m.jsx)(Pe,{}),Object(m.jsx)(Fe,{})]})}var Ce=a(35),Ve=a(105),Ie=a(62),Be=a.n(Ie);function We(){var e=Object(l.c)();Object(n.useEffect)((function(){var t=setInterval((function(){e((function(e,t){var a=t(),n=ae(a).filter((function(e){return!e.closestPoint.isInFront&&e.closestPoint.distance>2e4}));e(J({pageids:n.map((function(e){return e.pageid}))}))}))}),3e4);return function(){clearInterval(t)}}),[e])}function Te(e){var t=Object(l.d)(Z);return e?"https://".concat(t,".wikipedia.org/?curid=").concat(e.pageid):null}var Ae=a(64),Qe=a(42),De=a.n(Qe);function Je(e){var t=e.isReading,a=e.tts;return Object(m.jsxs)(m.Fragment,{children:[!t&&Object(m.jsx)(u.h,{size:32}),t&&a&&Object(m.jsx)(Ae.a,{className:De.a.speaker,size:32,stroke:"black",strokeWidth:1,color:"#FFF"}),t&&!a&&Object(m.jsx)(u.a,{className:De.a.speaker,size:30})]})}var qe=n.memo((function(e){var t,a=e.page,n=e.isCurrentPage,i=e.isPlaying,r=a.pageid,c=a.coordinates,o=De.a.marker;return n&&(o+=" ".concat(De.a.current)),null!==(t=null===c||void 0===c?void 0:c.map((function(e,t){return Object(m.jsx)(Be.a,{position:e,icon:Object(m.jsx)("div",{className:De.a.container,children:Object(m.jsx)("div",{className:o,children:Object(m.jsx)(Je,{isReading:i&&n,tts:!0})})})},"".concat(r,"-").concat(t))})))&&void 0!==t?t:null}));function Le(){var e,t=Object(l.d)(ae),a=null===(e=Object(l.d)(ne))||void 0===e?void 0:e[0],i=Object(l.d)(be);return function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e4,i=Object(l.c)(),r=Object(l.d)(X),c=Object(l.d)(Y),o=Object(l.d)(ee),s=Object(l.d)(te),u=Object(l.d)(ie);Object(n.useEffect)((function(){var e,n;if(u&&r){var l=[null!==(e=u.latitude)&&void 0!==e?e:0,null!==(n=u.longitude)&&void 0!==n?n:0],d=(null===l||void 0===l?void 0:l[0])!==(null===c||void 0===c?void 0:c[0])||(null===l||void 0===l?void 0:l[1])!==(null===c||void 0===c?void 0:c[1]),p=t!==o,b=(new Date).getTime()-s;(d&&b>a||p)&&i(H(l[0],l[1],t))}}),[i,r,u,c,t,o,s,a])}(Object(l.d)(g).position,Object(l.d)($)),We(),null===t||void 0===t?void 0:t.map((function(e){return Object(m.jsx)(qe,{page:e,isPlaying:i,isCurrentPage:(null===a||void 0===a?void 0:a.pageid)===(null===e||void 0===e?void 0:e.pageid)},e.pageid)}))}var Ge=a(118),Ue=a.n(Ge),He=a(107),Xe=a(119),Ze=n.memo((function(e){var t=e.currentMap,a='&copy; <a target="_blank" href="https://en.wikipedia.org">Wikipedia</a>, '+"".concat(t.attribution,", ")+'&copy; <a target="_blank" href="https://react-leaflet.js.org/">react-leaflet</a>, '+'<a target="_blank" href="https://github.com/kivle/msfs-map">MSFS-map</a> v'.concat(Xe.a),n=null,i=t.subdomains?{subdomains:t.subdomains}:{};return"tileServer"===t.type&&(n=Object(m.jsx)(He.a,Object(s.a)({attribution:a,url:t.tileServer},i),t.tileServer)),n}));function Ke(){var e,t,a=Object(Ce.a)(),i=Object(l.d)(g),r=i.position,c=i.heading,o=Object(l.d)(ke),s=Object(l.d)($),d=Object(l.d)(ie),p=[null!==(e=d.latitude)&&void 0!==e?e:0,null!==(t=d.longitude)&&void 0!==t?t:0],b=Object(l.d)(_e),j=Object(l.d)(X);Object(n.useEffect)((function(){b&&d&&a.setView([d.latitude,d.longitude],a.getZoom(),{animate:!0})}),[a,b,d]);var v=Object(m.jsx)("div",{className:Ue.a.plane,style:{transform:"rotate(".concat(c-90,"deg)")},children:Object(m.jsx)(u.e,{size:32,stroke:"white",strokeWidth:"40",fill:"#44F"})});return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Ze,{currentMap:o}),j&&Object(m.jsx)(Le,{}),r&&j&&Object(m.jsx)(Ve.a,{center:p,radius:s,color:"blue",fill:!1}),r&&Object(m.jsx)(Be.a,{position:r,icon:v})]})}var $e=a(120),Ye=a.n($e);function et(){return Object(m.jsxs)("div",{className:Ye.a.map,children:[Object(m.jsx)(Re,{}),Object(m.jsx)(o.a,{center:[51.505,-.09],zoom:13,children:Object(m.jsx)(Ke,{})})]})}a(215);var tt=a(121),at=a.n(tt),nt=a(122),it=a.n(nt),rt=a(124),ct=a(14),ot=a.n(ct),st=a(123),lt=a(83),ut=a.n(lt);function dt(e){var t,a=e.page,n=null!==(t=null===a||void 0===a?void 0:a.closestPoint)&&void 0!==t?t:{},i=n.distance,r=n.headingDifference;return Object(m.jsxs)("div",{className:ut.a.distance,children:[Object(m.jsx)(st.a,{className:ut.a.arrow,size:32,fill:"#AAA",stroke:"black",strokeWidth:1,style:{transform:"perspective(64px) rotate3d(1, 0, 0, 55deg) rotate(".concat(null!==r&&void 0!==r?r:0,"deg)")}}),Object(m.jsx)("span",{children:B(i)})]})}function pt(e){var t,a=e.page;return(null===a||void 0===a||null===(t=a.thumbnail)||void 0===t?void 0:t.source)?Object(m.jsx)("a",{href:a.thumbnail.source,target:"_blank",rel:"noopener noreferrer",children:Object(m.jsx)("img",{src:a.thumbnail.source,alt:a.title})}):null}function bt(){var e=Object(l.c)(),t=Object(l.d)(ne),a=t[0],i=t[1],r=null!==a&&void 0!==a?a:{},c=r.title,o=r.extract,s=Object(l.d)(de),d=Object(l.d)(be),p=Te(a),b=Te(i),j=Object(n.useCallback)((function(){e(ue(!d))}),[e,d]);Object(n.useEffect)((function(){d||speechSynthesis.cancel()}),[d]);var v=Object(n.useCallback)((function(){e(L())}),[e]);Object(n.useEffect)((function(){if(d&&c&&o&&s){var e="".concat(c,"\n\n").concat(o?Object(rt.decode)(it()(o)):""),t=new SpeechSynthesisUtterance(e);return t.voice=speechSynthesis.getVoices().find((function(e){return e.name===s})),t.onend=function(){v()},speechSynthesis.speak(t),function(){t.onend=null,speechSynthesis.cancel()}}}),[d,c,o,v,s]),Object(n.useEffect)((function(){var e=function(e){"n"===e.key?v():" "===e.key&&j()};return document.addEventListener("keypress",e),function(){return document.removeEventListener("keypress",e)}}),[v,j]);var g=a?Object(m.jsx)("a",{href:p,target:"_blank",rel:"noopener noreferrer",children:a.title}):null,f=i?Object(m.jsx)("a",{href:b,target:"_blank",rel:"noopener noreferrer",children:i.title}):null;return Object(m.jsxs)("div",{className:ot.a.player,children:[Object(m.jsx)("div",{className:ot.a.image,children:Object(m.jsx)(pt,{page:a})}),Object(m.jsxs)("div",{className:ot.a.info,children:[!g&&Object(m.jsx)("article",{className:ot.a.title,children:"No articles in reading queue"}),g&&Object(m.jsxs)("article",{className:ot.a.title,children:[Object(m.jsx)("div",{children:g}),Object(m.jsx)(dt,{page:a})]}),f&&Object(m.jsxs)("article",{className:ot.a.next,children:["next: ",f]})]}),Object(m.jsxs)("div",{className:ot.a.controls,children:[Object(m.jsxs)("button",{className:"".concat(ot.a.btn," ").concat(ot.a.gap),onClick:j,children:[d&&Object(m.jsx)(u.d,{size:"100%"}),!d&&Object(m.jsx)(u.f,{size:"100%"})]}),Object(m.jsx)("button",{className:"".concat(ot.a.btn),onClick:v,children:Object(m.jsx)(u.g,{size:"100%"})})]})]})}var jt=a(126),vt=a(125),gt=a(48),ft=a.n(gt);function mt(e){var t=e.page;return t.extract?Object(vt.a)(t.extract):null}function ht(e){var t,a=e.page;return(null===a||void 0===a||null===(t=a.thumbnail)||void 0===t?void 0:t.source)?Object(m.jsx)("a",{href:a.thumbnail.source,target:"_blank",rel:"noopener noreferrer",children:Object(m.jsx)("img",{src:a.thumbnail.source,alt:a.title})}):null}var Ot=i.a.memo((function(e){var t=e.page,a=Object(l.c)(),i=Te(t),r=t.pageid,c=Object(n.useCallback)((function(){a(q({pageid:r}))}),[a,r]),o=Object(n.useCallback)((function(){a(G({pageid:r}))}),[a,r]);return Object(m.jsxs)("article",{className:ft.a.page,children:[Object(m.jsxs)("div",{className:ft.a.title,children:[Object(m.jsx)("a",{href:i,target:"_blank",rel:"noreferrer",children:t.title}),Object(m.jsx)(dt,{page:t}),Object(m.jsx)(ht,{page:t})]}),Object(m.jsx)("div",{className:ft.a.text,children:Object(m.jsx)(mt,{page:t})}),Object(m.jsxs)("div",{className:ft.a.buttonBar,children:[Object(m.jsx)("button",{type:"button",onClick:c,children:Object(m.jsx)(Ae.a,{size:"100%"})}),Object(m.jsx)("button",{type:"button",onClick:o,children:Object(m.jsx)(jt.a,{size:"100%"})})]})]})}));function xt(){var e=Object(l.d)(ae);return Object(m.jsxs)("div",{className:at.a.sidebar,children:[Object(m.jsx)(bt,{}),Object(m.jsx)("div",{children:null===e||void 0===e?void 0:e.filter((function(e){return!e.isInPlayQueue})).map((function(e){return Object(m.jsx)(Ot,{page:e},e.pageid)}))})]})}var kt=function(){var e=Object(l.d)(X);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ws://localhost:9000/ws",t=Object(l.c)();Object(n.useEffect)((function(){var a=void 0,n=!1,i=void 0;return function r(){(a=new WebSocket(e)).onmessage=function(e){var a=JSON.parse(e.data);a.latitude>=0&&a.latitude<.015&&a.longitude>=0&&a.longitude<.015||t(v(a))},a.onerror=function(e){console.debug(e)},a.onclose=function(e){n||(i=setTimeout(r,2e3))}}(),function(){try{clearTimeout(i),n=!0,a.close(),a=void 0}catch(e){}}}),[t,e])}(),Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)(et,{}),e&&Object(m.jsx)(xt,{})]})},yt=Object(b.a)({reducer:{map:we,simdata:f,wikipedia:re,tts:je}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(232),a(5);window._store=yt,c.a.render(Object(m.jsx)(i.a.StrictMode,{children:Object(m.jsx)(l.a,{store:yt,children:Object(m.jsx)(kt,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},42:function(e,t,a){e.exports={container:"WikipediaMarker_container__3Rt_r",marker:"WikipediaMarker_marker__5fM6z",ratedBad:"WikipediaMarker_ratedBad__36bmw",current:"WikipediaMarker_current__sVu6_",speaker:"WikipediaMarker_speaker__DnvOa",pulse:"WikipediaMarker_pulse__1k_If"}},47:function(e,t,a){e.exports={main:"ButtonBar_main__3br2_",active:"ButtonBar_active__3Biec",gap:"ButtonBar_gap__2g3HT"}},48:function(e,t,a){e.exports={page:"WikipediaPage_page__3DUM5",title:"WikipediaPage_title__2vuru",text:"WikipediaPage_text__1JRH2",buttonBar:"WikipediaPage_buttonBar__1Jzum"}},82:function(e,t,a){e.exports={main:"PlaneInfo_main__9z7SN",infoField:"PlaneInfo_infoField__3d4Nw"}},83:function(e,t,a){e.exports={distance:"DistanceVisualizer_distance__8mVTT",arrow:"DistanceVisualizer_arrow__1P-h9"}}},[[233,1,2]]]);
//# sourceMappingURL=main.45d52b57.chunk.js.map