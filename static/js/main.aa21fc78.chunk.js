(this["webpackJsonpmsfs-map"]=this["webpackJsonpmsfs-map"]||[]).push([[0],{11:function(e,a,t){e.exports={main:"Preferences_main__ok2ws",preference:"Preferences_preference__191Je",preferenceButton:"Preferences_preferenceButton__FdKIq",expanded:"Preferences_expanded__Gn5Np",caret:"Preferences_caret__WiQ2N"}},130:function(e,a,t){e.exports={ttsPanel:"TtsPanel_ttsPanel__22ykE"}},131:function(e,a,t){e.exports={ui:"UI_ui__2LumD"}},133:function(e,a,t){e.exports={plane:"MapContent_plane__1IguB"}},134:function(e){e.exports=JSON.parse('{"a":"0.6.4"}')},135:function(e,a,t){e.exports={map:"Map_map__aNmAM"}},140:function(e,a,t){},239:function(e,a,t){},241:function(e,a,t){"use strict";t.r(a);var n=t(1),i=t.n(n),c=t(16),r=t.n(c),o=(t(140),t(118)),s=t(4),l=t(3),u=t(9),d=t(86),p=t.n(d),b=t(17),v=Object(b.b)({name:"simdata",initialState:{position:void 0,altitude:0,heading:0,airspeed:0,vertical_speed:0,airspeed_true:0,flaps:0,trim:0,rudder_trim:0},reducers:{updateData:function(e,a){var t=a.payload;e.position&&e.position[0]===t.latitude&&e.position[1]===t.longitude||(e.position=[t.latitude,t.longitude]),e.altitude=t.altitude,e.heading=t.heading,e.airspeed=t.airspeed,e.vertical_speed=t.vertical_speed,e.airspeed_true=t.airspeed_true,e.flaps=t.flaps,e.trim=t.trim,e.rudder_trim=t.rudder_trim}}}),g=v.actions.updateData,j=function(e){return e.simdata},h=v.reducer,f=t(2),m=n.memo((function(e){var a=e.airspeed,t=e.airspeed_true,n=e.altitude,i=e.heading,c=e.vertical_speed,r=e.flaps,o=e.trim,s=e.rudder_trim;return Object(f.jsxs)("div",{className:p.a.main,children:[Object(f.jsx)(O,{label:"Airspeed",value:"".concat(a," kt (").concat(t," kt)")}),Object(f.jsx)(O,{label:"Altitude",value:"".concat(n," ft")}),Object(f.jsx)(O,{label:"Heading",value:Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(u.d,{style:{transform:"rotate(".concat(i-90,"deg)")}})," ".concat(i,"\xb0")]})}),Object(f.jsx)(O,{label:"V. speed",value:"".concat(c," ft/s")}),0!==parseFloat(r)&&Object(f.jsx)(O,{label:"Flaps",value:"".concat(r)}),0!==parseFloat(o)&&Object(f.jsx)(O,{label:"Trim",value:"".concat(o,"%")}),0!==parseFloat(s)&&Object(f.jsx)(O,{label:"R.Trim",value:"".concat(s,"%")})]})}));function O(e){var a=e.label,t=e.value;e.unit;return Object(f.jsxs)("span",{className:p.a.infoField,children:[Object(f.jsx)("label",{children:a}),Object(f.jsx)("span",{children:t})]})}function y(){var e=Object(l.d)(j);return Object(f.jsx)(m,Object(s.a)({},e))}var x=t(88),k=t(11),S=t.n(k),_=t(14),w=Object(b.b)({name:"tts",initialState:{currentVoice:void 0,availableVoices:[],isPlaying:!0},reducers:{setVoice:function(e,a){var t=a.payload;e.currentVoice=t},setAvailableVoices:function(e,a){var t=a.payload;e.availableVoices=t,e.voice&&!e.availableVoices.some((function(a){return a===e.voice}))&&(e.voice=void 0)},setIsPlaying:function(e,a){e.isPlaying=a.payload}}}),P=w.actions,z=P.setVoice,N=P.setAvailableVoices,C=P.setIsPlaying,R=function(e){return e.tts.currentVoice},E=function(e){return e.tts.availableVoices},M=function(e){return e.tts.isPlaying},F=w.reducer,V=t(122),I=t(20),D=t.n(I),L=t(40),Q=t(47),W=t(38),A=t(39),B=function(){function e(){Object(W.a)(this,e)}return Object(A.a)(e,[{key:"getWikipediaApiUrl",value:function(e,a){var t=Object.keys(a).reduce((function(e,t){return e&&(e+="&"),"".concat(e).concat(encodeURIComponent(t),"=").concat(encodeURIComponent(a[t]))}),"");return"https://".concat(e,".wikipedia.org/w/api.php?").concat(t)}},{key:"getPagesByGeoLocation",value:function(){var e=Object(L.a)(D.a.mark((function e(a,t,n,i){var c,r,o,s;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={format:"json",action:"query",generator:"geosearch",ggslimit:20,ggsradius:i,ggscoord:t+"|"+n,origin:"*",prop:"extracts|pageimages|coordinates",exsentences:"10",exintro:!0,exlimit:20,pithumbsize:"400",imlimit:"10"},r=this.getWikipediaApiUrl(a,c),e.next=4,fetch(r);case 4:return o=e.sent,e.next=7,o.json();case 7:return s=e.sent,e.abrupt("return",s);case 9:case"end":return e.stop()}}),e,this)})));return function(a,t,n,i){return e.apply(this,arguments)}}()}]),e}(),T=new B,J=function(){function e(a,t){Object(W.a)(this,e),this.api=a,this.storage=t}return Object(A.a)(e,[{key:"getPagesByGeoLocation",value:function(){var e=Object(L.a)(D.a.mark((function e(a,t,n,i){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.getPagesByGeoLocation(a,t,n,i);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(a,t,n,i){return e.apply(this,arguments)}}()}]),e}(),q=new J(T,window.localStorage),U=["en","ceb","sv","de","fr","nl","ru","it","es","pl","war","vi","ja","zh","arz","ar","uk","pt","fa","ca","sr","id","no","ko","fi","hu","cs","sh","ro","zh-min-nan","tr","eu","ms","ce","eo","he","hy","bg","da","azb","sk","kk","min","hr","et","lt","be","el","simple","az","sl","gl","ur","nn","tt","hi","ka","th","uz","la","cy","ta","vo","mk","ast","lv","zh-yue","tg","bn","af","mg","oc","bs","sq","ky","nds","new","be-tarask","ml","te","br","tl","vec","pms","mr","su","ht","sw","lb","jv","pnb","ba","ga","szl","is","my","sco","fy","cv","lmo","wuu","an","pa","ne","diq","ku","yo","bar","io","gu","ckb","als","kn","scn","bpy","qu","ia","mn","bat-smg","si","nv","or","cdo","ilo","gd","xmf","yi","am","nap","bug","wa","sd","hsb","mai","fo","map-bms","mzn","li","sah","eml","os","ps","sa","frr","bcl","zh-classical","ace","mrj","mhr","avk","hif","gor","hak","roa-tara","pam","hyw","km","nso","rue","crh","se","bh","as","shn","vls","mi","nds-nl","nah","sc","vep","gan","myv","sn","ab","glk","bo","lrc","co","so","tk","fiu-vro","csb","ha","kv","ie","gv","udm","pcd","ay","kab","zea","sat","nrm","ug","lij","zu","kw","frp","lez","ban","stq","lfn","gn","mwl","gom","rm","mt","lo","lad","koi","fur","olo","ang","dty","dsb","bjn","ext","ln","cbk-zam","dv","ksh","tyv","ary","gag","pfl","pag","pi","av","awa","haw","bxr","xal","krc","pap","za","pdc","rw","kaa","szy","arc","to","nov","jam","tpi","kbp","kbd","ig","inh","na","tet","wo","tcy","ki","atj","jbo","roa-rup","bi","lbe","kg","ty","lg","mdf","fj","srn","xh","gcr","ltg","lld","chr","ak","om","sm","kl","got","pih","st","cu","ny","nqo","tn","tw","ts","rmy","bm","mnw","chy","rn","tum","ss","ch","iu","pnt","ks","ady","ve","ee","ik","ff","sg","dz","ti","cr","din","ng","cho","kj","mh","ho","ii","aa","mus","hz","kr"],G=t(18),H=t(24);function Y(e){return 0===e||e?e<1e3?"".concat(Math.round(e)," m"):"".concat(e<99999?(e/1e3).toFixed(1):Math.round(e/1e3)," km"):""}var Z=Object(b.b)({name:"wikipedia",initialState:{edition:"en",isEnabled:!0,availableEditions:U,pages:[],pagesViewed:[],playQueue:[],lastSearchPosition:void 0,lastSearchRadius:void 0,lastSearchTime:void 0,searchRadius:1e4,autoPlay:!0,autoPlayDistance:1e3},reducers:{setEnabled:function(e,a){a.payload?e.isEnabled=!0:(e.isEnabled=!1,e.pages=[],e.pagesViewed=[],e.playQueue=[],e.lastSearchPosition=void 0,e.lastSearchRadius=void 0,e.lastSearchTime=void 0)},receivePages:function(e,a){var t,n=a.payload,i=n.data,c=(i=void 0===i?{}:i).query,r=(c=void 0===c?{}:c).pages,o=n.searchPosition,s=n.searchRadius,l=n.searchTime;if(r){var u=Object.keys(r).reduce((function(e,a){return e.push(r[a]),e}),[]).filter((function(a){return!e.pages.some((function(e){return a.pageid===e.pageid}))&&!e.pagesViewed.some((function(e){return a.pageid===e}))&&a.coordinates}));(t=e.pages).push.apply(t,Object(Q.a)(u)),e.lastSearchPosition=o,e.lastSearchRadius=s,e.lastSearchTime=l}},removePages:function(e,a){var t=a.payload.pageids;e.pages=e.pages.filter((function(e){return!t.includes(e.pageid)}))},addToPlayQueue:function(e,a){var t=a.payload.pageid;e.playQueue.push(t)},advancePlayQueue:function(e,a){var t=a.payload.nextPageId,n=e.playQueue.shift();e.playQueue=[].concat(Object(Q.a)(t?[t]:[]),Object(Q.a)(e.playQueue.filter((function(e){return e!==t})))),e.pages=e.pages.filter((function(e){return e.pageid!==n})),e.pagesViewed.push(n)},markAsRead:function(e,a){var t=a.payload.pageid;e.pages=e.pages.filter((function(e){return e.pageid!==t})),e.pagesViewed.push(t)},setEdition:function(e,a){var t=a.payload;e.edition=t,e.pages=[],e.pagesViewed=[],e.playQueue=[],e.lastSearchPosition=void 0,e.lastSearchRadius=void 0,e.lastSearchTime=void 0},setSearchRadius:function(e,a){e.searchRadius=parseInt(a.payload,10)},setAutoPlay:function(e,a){var t=a.payload,n=t.enabled,i=t.distance;void 0!==n&&(e.autoPlay=n),void 0!==i&&(e.autoPlayDistance=i)}}}),K=Z.actions,X=K.setEnabled,$=K.setEdition,ee=K.receivePages,ae=K.removePages,te=K.addToPlayQueue,ne=K.markAsRead,ie=(K.setSearchRadius,K.updatePageRatings,K.setAutoPlay);function ce(e,a){var t=e.closestPoint.distance-a.closestPoint.distance;return 0===t&&(t=e.title.localeCompare(a.title)),0===t&&(t=e.pageid-a.pageid),t}var re=function(e,a,t){return function(){var n=Object(L.a)(D.a.mark((function n(i,c){var r,o,s;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=c(),o=se(r),n.next=4,q.getPagesByGeoLocation(o,e,a,t);case 4:(s=n.sent)&&i(ee({data:s,searchPosition:[e,a],searchRadius:t,searchTime:(new Date).getTime()}));case 6:case"end":return n.stop()}}),n)})));return function(e,a){return n.apply(this,arguments)}}()},oe=function(e){return e.wikipedia.isEnabled},se=function(e){return e.wikipedia.edition},le=function(e){return e.wikipedia.availableEditions},ue=function(e){return e.wikipedia.searchRadius},de=function(e){return e.wikipedia.lastSearchPosition},pe=function(e){return e.wikipedia.lastSearchRadius},be=function(e){return e.wikipedia.lastSearchTime},ve=function(e){return e.wikipedia.autoPlay},ge=function(e){return e.wikipedia.autoPlayDistance},je=Object(G.a)((function(e){var a,t,n,i;return{position:null===(a=e.simdata)||void 0===a?void 0:a.position,heading:null===(t=e.simdata)||void 0===t?void 0:t.heading,pages:null===(n=e.wikipedia)||void 0===n?void 0:n.pages,playQueue:null===(i=e.wikipedia)||void 0===i?void 0:i.playQueue}}),(function(e){var a=e.position,t=e.heading,n=e.pages,i=e.playQueue,c=a?{latitude:a[0],longitude:a[1]}:void 0,r=null===n||void 0===n?void 0:n.map((function(e){var a,n=null===(a=e.coordinates)||void 0===a?void 0:a.map((function(e){var a=c&&Object(H.getDistance)(c,{latitude:null===e||void 0===e?void 0:e.lat,longitude:null===e||void 0===e?void 0:e.lon}),n=c&&Math.round(Object(H.getRhumbLineBearing)(c,{latitude:null===e||void 0===e?void 0:e.lat,longitude:null===e||void 0===e?void 0:e.lon})),i=(((null!==n&&void 0!==n?n:0)-(null!==t&&void 0!==t?t:0))%360+540)%360-180;return{coord:e,distance:a,bearing:n,headingDifference:i,isInFront:i>=-90&&i<=90}})).sort((function(e,a){return e.distance-a.distance}))[0];return Object(s.a)(Object(s.a)({},e),{},{closestPoint:n,isInPlayQueue:i.includes(e.pageid),isReading:i[0]===e.pageid})})).sort(ce);return[].concat(Object(Q.a)(r.filter((function(e){var a;return null===(a=e.closestPoint)||void 0===a?void 0:a.isInFront}))),Object(Q.a)(r.filter((function(e){var a;return!(null===(a=e.closestPoint)||void 0===a?void 0:a.isInFront)}))))})),he=Object(G.a)((function(e){var a;return{pages:je(e),playQueue:null===(a=e.wikipedia)||void 0===a?void 0:a.playQueue}}),(function(e){var a=e.pages;return e.playQueue.map((function(e){return a.find((function(a){return a.pageid===e}))}))})),fe=Object(G.a)((function(e){var a,t,n,i;return{position:null===(a=e.simdata)||void 0===a?void 0:a.position,heading:null===(t=e.simdata)||void 0===t?void 0:t.heading,speed:null===(n=e.simdata)||void 0===n?void 0:n.airspeed,searchRadius:null===(i=e.wikipedia)||void 0===i?void 0:i.searchRadius}}),(function(e){var a=e.position,t=e.heading,n=e.searchRadius,i=e.speed;return a?i>50?Object(H.computeDestinationPoint)({latitude:a[0],longitude:a[1]},n,t):{latitude:a[0],longitude:a[1]}:void 0})),me=Z.reducer,Oe=[{name:"OpenStreetMap",type:"tileServer",tileServer:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors'},{name:"Stamen toner",type:"tileServer",tileServer:"http://{s}.tile.stamen.com/toner/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank\' href="http://maps.stamen.com">Stamen</a>'},{name:"Stamen terrain",type:"tileServer",tileServer:"http://{s}.tile.stamen.com/terrain/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank\' href="http://maps.stamen.com">Stamen</a>'},{name:"Stamen watercolor",type:"tileServer",tileServer:"http://{s}.tile.stamen.com/watercolor/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank\' href="http://maps.stamen.com">Stamen</a>'},{name:"Carto Dark",type:"tileServer",tileServer:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank\' href="https://carto.com">Carto</a>'},{name:"Carto (voyager)",type:"tileServer",tileServer:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",attribution:'&copy; <a target="_blank" href="https://osm.org/copyright">OpenStreetMap</a> <a target="_blank" href="https://carto.com/">Carto</a>',subdomains:"abcd"},{name:"Airspace data (OpenAIP)",type:"tileServer",tileServer:"https://{s}.tile.maps.openaip.net/geowebcache/service/tms/1.0.0/openaip_basemap@EPSG%3A900913@png/{z}/{x}/{y}.png",attribution:'"Airspace data: <a target="_blank" href="https://www.openaip.net/">OpenAIP</a>',subdomains:"12"}],ye=Object(b.b)({name:"map",initialState:{isFollowing:!0,currentMap:"OpenStreetMap",availableMaps:Oe,visualizeSearchRadius:!0,courseLine:!0},reducers:{setCurrentMap:function(e,a){e.currentMap=a.payload},setIsFollowing:function(e,a){e.isFollowing=a.payload},setVisualizeSearchRadius:function(e,a){e.visualizeSearchRadius=a.payload},setShowCourseLine:function(e,a){e.courseLine=a.payload}}}),xe=ye.actions,ke=(xe.updateMsfs,xe.setCurrentMap),Se=xe.setIsFollowing,_e=xe.setVisualizeSearchRadius,we=xe.setShowCourseLine,Pe=function(e){return e.map.availableMaps.find((function(a){return a.name===e.map.currentMap}))},ze=function(e){return e.map.availableMaps},Ne=function(e){return e.map.isFollowing},Ce=function(e){return e.map.visualizeSearchRadius},Re=function(e){return e.map.courseLine},Ee=Object(G.a)((function(e){var a,t;return{position:null===(a=j(e))||void 0===a?void 0:a.position,heading:null===(t=j(e))||void 0===t?void 0:t.heading}}),(function(e){var a=e.position,t=e.heading,n=a?{latitude:a[0],longitude:a[1]}:void 0;return n&&t?Object(H.computeDestinationPoint)(n,5e5,t):void 0})),Me=ye.reducer;var Fe=n.memo((function(e){var a=e.expanded,t=e.toggleExpanded,n=e.changeMap,i=e.currentMap,c=e.availableMaps,r=e.changeEdition,o=e.edition,s=e.availableEditions,l=e.changeVoice,d=e.voice,p=e.availableVoices,b=e.autoPlay,v=e.autoPlayDistance,g=e.changeAutoPlay,j=e.visualizeSearchRadius,h=e.changeVisualizeSearchRadius,m=e.courseLine,O=e.changeShowCourseLine;return Object(f.jsxs)("div",{className:S.a.main,children:[Object(f.jsxs)("button",{className:"".concat(S.a.preferenceButton).concat(a?" ".concat(S.a.expanded):""),onClick:t,children:[Object(f.jsx)(u.b,{size:"100%"}),Object(f.jsx)(u.a,{className:S.a.caret})]}),a&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{className:S.a.preference,children:[Object(f.jsx)("label",{htmlFor:"mapserver",children:"Map"}),Object(f.jsx)("select",{id:"mapserver",onChange:n,value:i.name,children:c.map((function(e){var a=e.name;return Object(f.jsx)("option",{value:a,children:a},a)}))})]}),Object(f.jsxs)("div",{className:S.a.preference,children:[Object(f.jsx)("label",{htmlFor:"wikipedia-edition",children:"Wikipedia Edition"}),Object(f.jsx)("select",{id:"wikipedia-edition",onChange:r,value:o,children:s.map((function(e){return Object(f.jsx)("option",{value:e,children:x.a.getName(e)?"".concat(x.a.getName(e)," (").concat(e,")"):e},e)}))})]}),Object(f.jsxs)("div",{className:S.a.preference,children:[Object(f.jsx)("label",{htmlFor:"visualizeSearchRadius",children:"Visualize search radius on map"}),Object(f.jsx)("input",{id:"visualizeSearchRadius",type:"checkbox",checked:j,onChange:function(e){return h(e.target.checked)}})]}),Object(f.jsxs)("div",{className:S.a.preference,children:[Object(f.jsx)("label",{htmlFor:"showCourseLine",children:"Show course line"}),Object(f.jsx)("input",{id:"showCourseLine",type:"checkbox",checked:m,onChange:function(e){return O(e.target.checked)}})]}),Object(f.jsxs)("div",{className:S.a.preference,children:[Object(f.jsx)("label",{htmlFor:"voice",children:"Voice"}),Object(f.jsx)("select",{id:"voice",onChange:l,value:d,children:p.map((function(e){return Object(f.jsx)("option",{value:e,children:e},e)}))})]}),Object(f.jsxs)("div",{className:S.a.preference,children:[Object(f.jsx)("label",{htmlFor:"autoPlay",children:"Enable automatically reading articles"}),Object(f.jsx)("input",{id:"autoPlay",type:"checkbox",checked:b,onChange:function(e){return g(e.target.checked)}})]}),b&&Object(f.jsxs)("div",{className:S.a.preference,children:[Object(f.jsx)("label",{htmlFor:"autoPlayDistance",children:"Read articles when they are in front and within distance"}),Object(f.jsx)("select",{id:"autoPlayDistance",onChange:function(e){return g(void 0,parseInt(e.target.value,10))},value:v,children:[100,500,1e3,2e3,5e3,1e4,2e4].map((function(e){return Object(f.jsx)("option",{value:e,children:"".concat(e," m")},e)}))})]})]})]})}));function Ve(){var e={edition:Object(l.d)(se),availableEditions:Object(l.d)(le),voice:Object(l.d)(R),availableVoices:Object(l.d)(E),currentMap:Object(l.d)(Pe),availableMaps:Object(l.d)(ze),autoPlay:Object(l.d)(ve),autoPlayDistance:Object(l.d)(ge),visualizeSearchRadius:Object(l.d)(Ce),courseLine:Object(l.d)(Re)},a=e.edition,t=e.availableEditions,i=e.voice,c=e.availableVoices,r=e.currentMap,o=e.availableMaps,s=e.autoPlay,u=e.autoPlayDistance,d=e.visualizeSearchRadius,p=e.courseLine;!function(){var e=Object(l.c)();Object(n.useEffect)((function(){Object(l.b)((function(){localStorage["wikipedia-enabled"]&&e(X(JSON.parse(localStorage["wikipedia-enabled"]))),localStorage["wikipedia-edition"]&&e($(localStorage["wikipedia-edition"])),localStorage.voice&&e(z(localStorage.voice)),localStorage.currentMap&&e(ke(localStorage.currentMap)),localStorage.autoPlay&&e(ie({enabled:JSON.parse(localStorage.autoPlay)})),localStorage.autoPlayDistance&&e(ie({distance:JSON.parse(localStorage.autoPlayDistance)})),localStorage.visualizeSearchRadius&&e(_e(JSON.parse(localStorage.visualizeSearchRadius))),localStorage.courseLine&&e(we(JSON.parse(localStorage.courseLine)))}))}),[e])}(),function(){var e=Object(l.c)();Object(n.useEffect)((function(){var a=function(){var a=window.speechSynthesis.getVoices();e(N(a.map((function(e){return e.name}))))};return a(),window.speechSynthesis.addEventListener("voiceschanged",a),function(){return window.speechSynthesis.removeEventListener("voiceschanged",a)}}),[e])}();var b=function(){var e=Object(l.c)();return{changeEdition:Object(n.useCallback)((function(a){localStorage["wikipedia-edition"]=a.target.value,e($(a.target.value))}),[e]),changeVoice:Object(n.useCallback)((function(a){localStorage.voice=a.target.value,e(z(a.target.value))}),[e]),changeMap:Object(n.useCallback)((function(a){localStorage.currentMap=a.target.value,e(ke(a.target.value))}),[e]),changeAutoPlay:Object(n.useCallback)((function(a,t){void 0!==a&&(localStorage.autoPlay=JSON.stringify(a)),void 0!==t&&(localStorage.autoPlayDistance=JSON.stringify(t)),e(ie({enabled:a,distance:t}))}),[e]),changeVisualizeSearchRadius:Object(n.useCallback)((function(a){localStorage.visualizeSearchRadius=JSON.stringify(a),e(_e(a))}),[e]),changeShowCourseLine:Object(n.useCallback)((function(a){localStorage.courseLine=JSON.stringify(a),e(we(a))}),[e])}}(),v=b.changeEdition,g=b.changeVoice,j=b.changeMap,h=b.changeAutoPlay,m=b.changeVisualizeSearchRadius,O=b.changeShowCourseLine,y=function(){var e=Object(n.useState)(!1),a=Object(_.a)(e,2),t=a[0],i=a[1];return{toggleExpanded:Object(n.useCallback)((function(e){i(!t)}),[t]),expanded:t}}(),x=y.toggleExpanded,k=y.expanded;return Object(f.jsx)(Fe,{expanded:k,toggleExpanded:x,changeMap:j,currentMap:r,availableMaps:o,changeEdition:v,edition:a,availableEditions:t,changeVoice:g,voice:i,availableVoices:c,autoPlay:s,autoPlayDistance:u,changeAutoPlay:h,visualizeSearchRadius:d,changeVisualizeSearchRadius:m,courseLine:p,changeShowCourseLine:O})}var Ie=t(123),De=t(52),Le=t.n(De),Qe=n.memo((function(e){var a=e.isFollowing,t=e.toggleFollow,n=e.isWikipediaEnabled,i=e.toggleIsEnabled;return Object(f.jsxs)("div",{className:Le.a.main,children:[Object(f.jsx)("button",{className:"".concat(a?Le.a.active:""),onClick:t,children:Object(f.jsx)(Ie.a,{size:"100%"})}),Object(f.jsx)("button",{className:"".concat(Le.a.gap," ").concat(n?Le.a.active:""),onClick:i,children:Object(f.jsx)(u.g,{size:"100%"})})]})}));function We(){var e=Object(l.c)(),a=Object(l.d)(Ne),t=Object(n.useCallback)((function(){e(Se(!a))}),[e,a]),i=Object(l.d)(oe),c=Object(n.useCallback)((function(){localStorage["wikipedia-enabled"]=JSON.stringify(!i),e(X(!i))}),[e,i]);return Object(f.jsx)(Qe,{isFollowing:a,toggleFollow:t,isWikipediaEnabled:i,toggleIsEnabled:c})}var Ae=t(124),Be=t.n(Ae),Te=t(125);function Je(e){var a=Object(l.c)(),t=Object(n.useCallback)((function(){a(C(!e))}),[a,e]),i=Object(n.useCallback)((function(){a((function(e,a){var t,n=a(),i=he(n),c=Object(V.a)(i).slice(1).sort(ce);e(Z.actions.advancePlayQueue({nextPageId:null===(t=c[0])||void 0===t?void 0:t.pageid}))}))}),[a]);return{togglePlaybackState:t,next:i}}var qe=t(25),Ue=t.n(qe),Ge=function(e){var a=e.togglePlaybackState,t=e.isPlaying,n=e.next;return Object(f.jsxs)("div",{className:Ue.a.controls,children:[Object(f.jsxs)("button",{className:"".concat(Ue.a.btn," ").concat(Ue.a.gap),onClick:a,children:[t&&Object(f.jsx)(u.c,{size:"100%"}),!t&&Object(f.jsx)(u.e,{size:"100%"})]}),Object(f.jsx)("button",{className:"".concat(Ue.a.btn),onClick:n,children:Object(f.jsx)(u.f,{size:"100%"})})]})},He=i.a.memo(Ge),Ye=function(e){var a=e.currentPage,t=e.togglePlaybackState,n=e.isPlaying,i=e.next,c=e.playQueue;return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("div",{className:Ue.a.player,children:[Object(f.jsxs)("div",{className:Ue.a.info,children:[!a&&"No articles in reading queue",a&&"".concat(c.length," articles in reading queue")]}),Object(f.jsx)(He,{isPlaying:n,togglePlaybackState:t,next:i})]})})},Ze=i.a.memo(Ye);function Ke(){var e=function(){var e=Object(l.d)(he),a=e[0],t=null!==a&&void 0!==a?a:{};return{currentPage:a,title:t.title,extract:t.extract,voice:Object(l.d)(R),isPlaying:Object(l.d)(M),playQueue:e}}(),a=e.currentPage,t=e.title,i=e.extract,c=e.voice,r=e.isPlaying,o=e.playQueue,s=Je(r),u=s.togglePlaybackState,d=s.next;return function(e,a,t,i,c){Object(n.useEffect)((function(){e||speechSynthesis.cancel()}),[e]),Object(n.useEffect)((function(){if(e&&a&&t&&c){var n="".concat(a,"\n\n").concat(t?Object(Te.decode)(Be()(t)):""),r=new SpeechSynthesisUtterance(n);return r.voice=speechSynthesis.getVoices().find((function(e){return e.name===c})),r.onend=function(){i()},speechSynthesis.speak(r),function(){r.onend=null,speechSynthesis.cancel()}}}),[e,a,t,i,c])}(r,t,i,d,c),function(e,a){Object(n.useEffect)((function(){var t=function(t){"n"===t.key?e():" "===t.key&&a()};return document.addEventListener("keypress",t),function(){return document.removeEventListener("keypress",t)}}),[e,a])}(d,u),Object(f.jsx)(Ze,{currentPage:a,togglePlaybackState:u,isPlaying:r,next:d,playQueue:o})}var Xe=t(129),$e=t(126);function ea(){var e=Object(l.c)();Object(n.useEffect)((function(){var a=setInterval((function(){e((function(e,a){var t,n=a(),i=je(n),c=null===(t=he(n))||void 0===t?void 0:t.map((function(e){return e.pageid})),r=i.length>80?i.filter((function(e,a){return a>=80&&!(null===c||void 0===c?void 0:c.includes(e.pageid))})):i.filter((function(e){return!e.closestPoint.isInFront&&e.closestPoint.distance>4e4&&!(null===c||void 0===c?void 0:c.includes(e.pageid))}));e(ae({pageids:r.map((function(e){return e.pageid}))}))}))}),3e4);return function(){clearInterval(a)}}),[e])}var aa=t(127),ta=t(43),na=t.n(ta),ia=t(50),ca=t(128),ra=t(87),oa=t.n(ra);function sa(e){var a,t=e.page,n=null!==(a=null===t||void 0===t?void 0:t.closestPoint)&&void 0!==a?a:{},i=n.distance,c=n.headingDifference;return Object(f.jsxs)("div",{className:oa.a.distance,children:[Object(f.jsx)(ca.a,{className:oa.a.arrow,size:32,fill:"#AAA",stroke:"black",strokeWidth:1,style:{transform:"perspective(64px) rotate3d(1, 0, 0, 55deg) rotate(".concat(null!==c&&void 0!==c?c:0,"deg)")}}),Object(f.jsx)("span",{children:Y(i)})]})}function la(e){var a=e.page;return a.extract?Object(aa.a)(a.extract):null}function ua(e){var a,t=e.page;return(null===t||void 0===t||null===(a=t.thumbnail)||void 0===a?void 0:a.source)?Object(f.jsx)("a",{href:t.thumbnail.source,target:"_blank",rel:"noopener noreferrer",children:Object(f.jsx)("img",{src:t.thumbnail.source,alt:t.title})}):null}var da=function(e){var a=e.page,t=Object(l.c)(),i=function(e){var a=Object(l.d)(se);return e?"https://".concat(a,".wikipedia.org/?curid=").concat(e.pageid):null}(a),c=a.pageid,r=Object(n.useCallback)((function(){t(te({pageid:c}))}),[t,c]),o=Object(n.useCallback)((function(){t(ne({pageid:c}))}),[t,c]);return Object(f.jsxs)("article",{className:na.a.page,children:[Object(f.jsxs)("div",{className:na.a.title,children:[a.isReading&&Object(f.jsx)(ia.a,{className:na.a.speaker,size:32,stroke:"black",strokeWidth:1,color:"#FFF"}),Object(f.jsx)("a",{href:i,target:"_blank",rel:"noreferrer",children:a.title}),Object(f.jsx)(sa,{page:a}),Object(f.jsx)(ua,{page:a})]}),Object(f.jsx)("div",{className:na.a.text,children:Object(f.jsx)(la,{page:a})}),!a.isInPlayQueue&&Object(f.jsxs)("div",{className:na.a.buttonBar,children:[Object(f.jsx)("button",{type:"button",onClick:r,children:Object(f.jsx)(ia.a,{size:"100%"})}),Object(f.jsx)("button",{type:"button",onClick:o,children:Object(f.jsx)(Xe.a,{size:"100%"})})]})]})},pa=i.a.memo(da),ba=t(130),va=t.n(ba);function ga(){var e=Object(l.d)(oe),a=Object(l.d)(he)[0];return e?Object(f.jsxs)("div",{className:va.a.ttsPanel,children:[Object(f.jsx)(Ke,{}),a&&Object(f.jsx)(pa,{page:a})]}):null}var ja=t(131),ha=t.n(ja);function fa(){return Object(f.jsxs)("div",{className:ha.a.ui,children:[Object(f.jsx)(y,{}),Object(f.jsx)(Ve,{}),Object(f.jsx)(We,{}),Object(f.jsx)(ga,{})]})}var ma=t(37),Oa=t(117),ya=t(119),xa=t(69),ka=t.n(xa),Sa=t(46),_a=t.n(Sa);function wa(e){var a=e.isReading;return Object(f.jsxs)(f.Fragment,{children:[!a&&Object(f.jsx)(u.g,{size:32}),a&&Object(f.jsx)(ia.a,{className:_a.a.speaker,size:32,stroke:"black",strokeWidth:1,color:"#FFF"})]})}var Pa=n.memo((function(e){var a,t=e.page,n=e.isCurrentPage,i=e.isPlaying,c=t.pageid,r=t.coordinates,o=t.isInPlayQueue,s=_a.a.marker;return n?s+=" ".concat(_a.a.current):o&&(s+=" ".concat(_a.a.queued)),null!==(a=null===r||void 0===r?void 0:r.map((function(e,a){return Object(f.jsx)(ka.a,{position:e,icon:Object(f.jsx)("div",{className:_a.a.container,children:Object(f.jsx)("div",{className:s,children:Object(f.jsx)(wa,{isReading:i&&n})})})},"".concat(c,"-").concat(a))})))&&void 0!==a?a:null}));function za(){var e,a=Object(l.d)(je),t=null===(e=Object(l.d)(he))||void 0===e?void 0:e[0],i=Object(l.d)(M);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e4,a=Object(l.c)(),t=Object(l.d)(oe),i=Object(l.d)(de),c=Object(l.d)(pe),r=Object(l.d)(be),o=Object(l.d)(ue),s=Object(l.d)(fe);Object(n.useEffect)((function(){var n,l;if(s&&t){var u=[null!==(n=s.latitude)&&void 0!==n?n:0,null!==(l=s.longitude)&&void 0!==l?l:0],d=!i||Object(H.getDistance)(s,{latitude:i[0],longitude:i[1]})>100,p=o!==c,b=(new Date).getTime()-r;(d&&b>e||p)&&a(re(u[0],u[1],o))}}),[a,t,s,i,o,c,r,e])}(),ea(),function(){var e=Object(l.c)(),a=Object(l.d)(ve),t=Object(l.d)(ge),i=Object(l.d)(je);Object(n.useEffect)((function(){if(a&&i){var n,c=i.filter((function(e){return e.closestPoint.isInFront&&e.closestPoint.distance<t&&!e.isInPlayQueue})),r=Object($e.a)(c);try{for(r.s();!(n=r.n()).done;){var o=n.value;e(te({pageid:o.pageid}))}}catch(s){r.e(s)}finally{r.f()}}}),[e,a,t,i])}(),null===a||void 0===a?void 0:a.map((function(e){return Object(f.jsx)(Pa,{page:e,isPlaying:i,isCurrentPage:(null===t||void 0===t?void 0:t.pageid)===(null===e||void 0===e?void 0:e.pageid)},e.pageid)}))}var Na=t(133),Ca=t.n(Na),Ra=t(120),Ea=t(134),Ma=n.memo((function(e){var a=e.currentMap,t='&copy; <a target="_blank" href="https://en.wikipedia.org">Wikipedia</a>, '+"".concat(a.attribution,", ")+'&copy; <a target="_blank" href="https://react-leaflet.js.org/">react-leaflet</a>, '+'<a target="_blank" href="https://github.com/kivle/msfs-map">MSFS-map</a> v'.concat(Ea.a),n=null,i=a.subdomains?{subdomains:a.subdomains}:{};return"tileServer"===a.type&&(n=Object(f.jsx)(Ra.a,Object(s.a)({attribution:t,url:a.tileServer},i),a.tileServer)),n}));function Fa(){var e,a,t=Object(ma.a)(),i=Object(l.d)(j),c=i.position,r=i.heading,o=Object(l.d)(Pe),s=Object(l.d)(ue),d=Object(l.d)(fe),p=d?[null!==(e=d.latitude)&&void 0!==e?e:0,null!==(a=d.longitude)&&void 0!==a?a:0]:void 0,b=Object(l.d)(Ne),v=Object(l.d)(oe),g=Object(l.d)(Ce),h=Object(l.d)(Re),m=Object(l.d)(Ee);Object(n.useEffect)((function(){b&&c&&t.setView(c,t.getZoom(),{animate:!0})}),[t,b,c]),Object(n.useEffect)((function(){t.invalidateSize()}),[t,v]);var O=Object(f.jsx)("div",{className:Ca.a.plane,style:{transform:"rotate(".concat(r-90,"deg)")},children:Object(f.jsx)(u.d,{size:32,stroke:"white",strokeWidth:"40",fill:"#44F"})});return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(Ma,{currentMap:o}),v&&Object(f.jsx)(za,{}),c&&v&&g&&Object(f.jsx)(Oa.a,{center:p,radius:s,color:"blue",fill:!1}),!!c&&!!h&&!!m&&Object(f.jsx)(ya.a,{positions:[c,[m.latitude,m.longitude]],pathOptions:{strokeWidth:1,color:"gray",opacity:.5}}),c&&Object(f.jsx)(ka.a,{position:c,icon:O})]})}var Va=t(135),Ia=t.n(Va);function Da(){return Object(f.jsxs)("div",{className:Ia.a.map,children:[Object(f.jsx)(fa,{}),Object(f.jsx)(o.a,{center:[51.505,-.09],zoom:13,children:Object(f.jsx)(Fa,{})})]})}t(239);var La=t(53),Qa=t.n(La);function Wa(){var e=Object(l.d)(je),a=null===e||void 0===e?void 0:e.filter((function(e){return!e.isInPlayQueue})),t=(null===a||void 0===a?void 0:a.length)>20?null===a||void 0===a?void 0:a.slice(0,20):a;return Object(f.jsx)("div",{className:Qa.a.sidebar,children:Object(f.jsxs)("div",{children:[!(null===a||void 0===a?void 0:a.length)&&Object(f.jsx)("div",{className:Qa.a.status,children:"No pages found. Results will show up here as you fly around the world."}),!!(null===a||void 0===a?void 0:a.length)&&Object(f.jsxs)("div",{className:Qa.a.status,children:[null===a||void 0===a?void 0:a.length," pages found."]}),null===t||void 0===t?void 0:t.map((function(e){return Object(f.jsx)("div",{className:Qa.a.pageContainer,children:Object(f.jsx)(pa,{page:e})},e.pageid)}))]})})}var Aa=function(){var e=Object(l.d)(oe);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ws://localhost:9000/ws",a=Object(l.c)();Object(n.useEffect)((function(){var t=void 0,n=!1,i=void 0;return function c(){(t=new WebSocket(e)).onmessage=function(e){var t=JSON.parse(e.data);t.latitude>=0&&t.latitude<.015&&t.longitude>=0&&t.longitude<.015||a(g(t))},t.onerror=function(e){console.debug(e)},t.onclose=function(e){n||(i=setTimeout(c,2e3))}}(),function(){try{clearTimeout(i),n=!0,t.close(),t=void 0}catch(e){}}}),[a,e])}(),Object(f.jsxs)("div",{className:"App",children:[Object(f.jsx)(Da,{}),e&&Object(f.jsx)(Wa,{})]})},Ba=Object(b.a)({reducer:{map:Me,simdata:h,wikipedia:me,tts:F}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(240),t(5);window._store=Ba,r.a.render(Object(f.jsx)(i.a.StrictMode,{children:Object(f.jsx)(l.a,{store:Ba,children:Object(f.jsx)(Aa,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},25:function(e,a,t){e.exports={player:"View_player__2u6ia",controls:"View_controls__1lpJp",info:"View_info__1AUmh"}},43:function(e,a,t){e.exports={page:"WikipediaPage_page__3j8zU",title:"WikipediaPage_title__1gae6",text:"WikipediaPage_text__3ztTt",buttonBar:"WikipediaPage_buttonBar__YD5uL",speaker:"WikipediaPage_speaker__nPyCJ"}},46:function(e,a,t){e.exports={container:"WikipediaMarker_container__3Rt_r",marker:"WikipediaMarker_marker__5fM6z",current:"WikipediaMarker_current__sVu6_",queued:"WikipediaMarker_queued__3gDRl",speaker:"WikipediaMarker_speaker__DnvOa",pulse:"WikipediaMarker_pulse__1k_If"}},52:function(e,a,t){e.exports={main:"ButtonBar_main__3br2_",active:"ButtonBar_active__3Biec",gap:"ButtonBar_gap__2g3HT"}},53:function(e,a,t){e.exports={sidebar:"Sidebar_sidebar__1kXOI",status:"Sidebar_status__fpfjB",pageContainer:"Sidebar_pageContainer__3NWwk"}},86:function(e,a,t){e.exports={main:"PlaneInfo_main__9z7SN",infoField:"PlaneInfo_infoField__3d4Nw"}},87:function(e,a,t){e.exports={distance:"DistanceVisualizer_distance__25YZl",arrow:"DistanceVisualizer_arrow__2OH0n"}}},[[241,1,2]]]);
//# sourceMappingURL=main.aa21fc78.chunk.js.map