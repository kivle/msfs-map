(this["webpackJsonpmsfs-map"]=this["webpackJsonpmsfs-map"]||[]).push([[0],{11:function(e,a,t){e.exports={main:"Preferences_main__ok2ws",preference:"Preferences_preference__191Je",preferenceButton:"Preferences_preferenceButton__FdKIq",expanded:"Preferences_expanded__Gn5Np",caret:"Preferences_caret__WiQ2N"}},130:function(e,a,t){e.exports={ttsPanel:"TtsPanel_ttsPanel__22ykE"}},131:function(e,a,t){e.exports={ui:"UI_ui__2LumD"}},133:function(e){e.exports=JSON.parse('{"a":"0.6.7"}')},134:function(e,a,t){e.exports={plane:"Plane_plane__31KyC"}},135:function(e,a,t){e.exports={map:"Map_map__aNmAM"}},140:function(e,a,t){},239:function(e,a,t){},241:function(e,a,t){"use strict";t.r(a);var n=t(1),i=t.n(n),c=t(16),r=t.n(c),o=(t(140),t(118)),s=t(4),l=t(3),u=t(9),d=t(86),p=t.n(d),b=t(17),v=Object(b.b)({name:"simdata",initialState:{position:void 0,altitude:0,heading:0,airspeed:0,vertical_speed:0,airspeed_true:0,flaps:0,trim:0,rudder_trim:0,connected:!1},reducers:{updateData:function(e,a){var t=a.payload;e.position&&e.position[0]===t.latitude&&e.position[1]===t.longitude||(e.position=[t.latitude,t.longitude]),e.altitude=t.altitude,e.heading=t.heading,e.airspeed=t.airspeed,e.vertical_speed=t.vertical_speed,e.airspeed_true=t.airspeed_true,e.flaps=t.flaps,e.trim=t.trim,e.rudder_trim=t.rudder_trim},setConnected:function(e,a){e.connected=a.payload}}}),g=v.actions,j=g.updateData,f=g.setConnected,h=function(e){return e.simdata},m=v.reducer,O=t(2),y=n.memo((function(e){var a=e.airspeed,t=e.airspeed_true,n=e.altitude,i=e.heading,c=e.vertical_speed,r=e.flaps,o=e.trim,s=e.rudder_trim,l=e.connected;return Object(O.jsxs)("div",{className:p.a.main,children:[!l&&"Disconnected from simulator. Start vfrmap.exe.",l&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(x,{label:"Airspeed",value:"".concat(a," kt (").concat(t," kt)")}),Object(O.jsx)(x,{label:"Altitude",value:"".concat(n," ft")}),Object(O.jsx)(x,{label:"Heading",value:Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(u.d,{style:{transform:"rotate(".concat(i-90,"deg)")}})," ".concat(i,"\xb0")]})}),Object(O.jsx)(x,{label:"V. speed",value:"".concat(c," ft/s")}),0!==parseFloat(r)&&Object(O.jsx)(x,{label:"Flaps",value:"".concat(r)}),0!==parseFloat(o)&&Object(O.jsx)(x,{label:"Trim",value:"".concat(o,"%")}),0!==parseFloat(s)&&Object(O.jsx)(x,{label:"R.Trim",value:"".concat(s,"%")})]})]})}));function x(e){var a=e.label,t=e.value;e.unit;return Object(O.jsxs)("span",{className:p.a.infoField,children:[Object(O.jsx)("label",{children:a}),Object(O.jsx)("span",{children:t})]})}function k(){var e=Object(l.d)(h);return Object(O.jsx)(y,Object(s.a)({},e))}var S=t(88),P=t(11),_=t.n(P),w=t(14),z=Object(b.b)({name:"tts",initialState:{currentVoice:void 0,availableVoices:[],isPlaying:!0},reducers:{setVoice:function(e,a){var t=a.payload;e.currentVoice=t},setAvailableVoices:function(e,a){var t=a.payload;e.availableVoices=t,e.voice&&!e.availableVoices.some((function(a){return a===e.voice}))&&(e.voice=void 0)},setIsPlaying:function(e,a){e.isPlaying=a.payload}}}),N=z.actions,C=N.setVoice,E=N.setAvailableVoices,F=N.setIsPlaying,D=function(e){return e.tts.currentVoice},R=function(e){return e.tts.availableVoices},I=function(e){return e.tts.isPlaying},M=z.reducer,V=t(122),Q=t(20),L=t.n(Q),W=t(42),A=t(26),T=t(40),B=t(41),J=function(){function e(){Object(T.a)(this,e)}return Object(B.a)(e,[{key:"getWikipediaApiUrl",value:function(e,a){var t=Object.keys(a).reduce((function(e,t){return e&&(e+="&"),"".concat(e).concat(encodeURIComponent(t),"=").concat(encodeURIComponent(a[t]))}),"");return"https://".concat(e,".wikipedia.org/w/api.php?").concat(t)}},{key:"getPagesByGeoLocation",value:function(){var e=Object(W.a)(L.a.mark((function e(a,t,n,i){var c,r,o,s;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={format:"json",action:"query",generator:"geosearch",ggslimit:20,ggsradius:i,ggscoord:t+"|"+n,origin:"*",prop:"extracts|pageimages|coordinates",exsentences:"10",exintro:!0,exlimit:20,pithumbsize:"400",imlimit:"10"},r=this.getWikipediaApiUrl(a,c),e.next=4,fetch(r);case 4:return o=e.sent,e.next=7,o.json();case 7:return s=e.sent,e.abrupt("return",s);case 9:case"end":return e.stop()}}),e,this)})));return function(a,t,n,i){return e.apply(this,arguments)}}()}]),e}(),q=new J,U=function(){function e(a,t){Object(T.a)(this,e),this.api=a,this.storage=t}return Object(B.a)(e,[{key:"getPagesByGeoLocation",value:function(){var e=Object(W.a)(L.a.mark((function e(a,t,n,i){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.getPagesByGeoLocation(a,t,n,i);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(a,t,n,i){return e.apply(this,arguments)}}()}]),e}(),G=new U(q,window.localStorage),H=["en","ceb","sv","de","fr","nl","ru","it","es","pl","war","vi","ja","zh","arz","ar","uk","pt","fa","ca","sr","id","no","ko","fi","hu","cs","sh","ro","zh-min-nan","tr","eu","ms","ce","eo","he","hy","bg","da","azb","sk","kk","min","hr","et","lt","be","el","simple","az","sl","gl","ur","nn","tt","hi","ka","th","uz","la","cy","ta","vo","mk","ast","lv","zh-yue","tg","bn","af","mg","oc","bs","sq","ky","nds","new","be-tarask","ml","te","br","tl","vec","pms","mr","su","ht","sw","lb","jv","pnb","ba","ga","szl","is","my","sco","fy","cv","lmo","wuu","an","pa","ne","diq","ku","yo","bar","io","gu","ckb","als","kn","scn","bpy","qu","ia","mn","bat-smg","si","nv","or","cdo","ilo","gd","xmf","yi","am","nap","bug","wa","sd","hsb","mai","fo","map-bms","mzn","li","sah","eml","os","ps","sa","frr","bcl","zh-classical","ace","mrj","mhr","avk","hif","gor","hak","roa-tara","pam","hyw","km","nso","rue","crh","se","bh","as","shn","vls","mi","nds-nl","nah","sc","vep","gan","myv","sn","ab","glk","bo","lrc","co","so","tk","fiu-vro","csb","ha","kv","ie","gv","udm","pcd","ay","kab","zea","sat","nrm","ug","lij","zu","kw","frp","lez","ban","stq","lfn","gn","mwl","gom","rm","mt","lo","lad","koi","fur","olo","ang","dty","dsb","bjn","ext","ln","cbk-zam","dv","ksh","tyv","ary","gag","pfl","pag","pi","av","awa","haw","bxr","xal","krc","pap","za","pdc","rw","kaa","szy","arc","to","nov","jam","tpi","kbp","kbd","ig","inh","na","tet","wo","tcy","ki","atj","jbo","roa-rup","bi","lbe","kg","ty","lg","mdf","fj","srn","xh","gcr","ltg","lld","chr","ak","om","sm","kl","got","pih","st","cu","ny","nqo","tn","tw","ts","rmy","bm","mnw","chy","rn","tum","ss","ch","iu","pnt","ks","ady","ve","ee","ik","ff","sg","dz","ti","cr","din","ng","cho","kj","mh","ho","ii","aa","mus","hz","kr"],K=t(18),Y=t(24);function Z(e){return e?{latitude:e[0],longitude:e[1]}:void 0}function X(e){return e?[e.latitude,e.longitude]:void 0}var $=Object(b.b)({name:"wikipedia",initialState:{edition:"en",isEnabled:!0,availableEditions:H,pages:[],calculatedData:{},pagesViewed:[],playQueue:[],lastSearchPosition:void 0,lastSearchRadius:void 0,lastSearchTime:void 0,searchRadius:1e4,autoPlay:!0,autoPlayDistance:1e3},reducers:{setEnabled:function(e,a){a.payload?e.isEnabled=!0:(e.isEnabled=!1,e.pages=[],e.calculatedData={},e.pagesViewed=[],e.playQueue=[],e.lastSearchPosition=void 0,e.lastSearchRadius=void 0,e.lastSearchTime=void 0)},receivePages:function(e,a){var t,n=a.payload,i=n.data,c=(i=void 0===i?{}:i).query,r=(c=void 0===c?{}:c).pages,o=n.searchPosition,s=n.searchRadius,l=n.searchTime;if(r){var u=Object.keys(r).reduce((function(e,a){return e.push(r[a]),e}),[]).filter((function(a){return!e.pages.some((function(e){return a.pageid===e.pageid}))&&!e.pagesViewed.some((function(e){return a.pageid===e}))&&a.coordinates}));(t=e.pages).push.apply(t,Object(A.a)(u)),e.lastSearchPosition=o,e.lastSearchRadius=s,e.lastSearchTime=l}},removePages:function(e,a){var t=a.payload.pageids;e.pages=e.pages.filter((function(e){return!t.includes(e.pageid)})),e.playQueue=e.playQueue.filter((function(e){return!t.includes(e)})),t.forEach((function(a){Object.hasOwnProperty.call(e.calculatedData,a)&&delete e.calculatedData[a]}))},addToPlayQueue:function(e,a){var t=a.payload.pageid;e.playQueue.push(t)},advancePlayQueue:function(e,a){var t=a.payload.nextPageId,n=e.playQueue.shift();e.playQueue=[].concat(Object(A.a)(t?[t]:[]),Object(A.a)(e.playQueue.filter((function(e){return e!==t})))),e.pages=e.pages.filter((function(e){return e.pageid!==n})),e.pagesViewed.push(n),Object.hasOwnProperty.call(e.calculatedData,n)&&delete e.calculatedData[n]},markAsRead:function(e,a){var t=a.payload.pageid;e.pages=e.pages.filter((function(e){return e.pageid!==t})),e.pagesViewed.push(t),Object.hasOwnProperty.call(e.calculatedData,t)&&delete e.calculatedData[t]},setEdition:function(e,a){var t=a.payload;e.edition=t,e.pages=[],e.calculatedData={},e.pagesViewed=[],e.playQueue=[],e.lastSearchPosition=void 0,e.lastSearchRadius=void 0,e.lastSearchTime=void 0},setSearchRadius:function(e,a){e.searchRadius=parseInt(a.payload,10)},setAutoPlay:function(e,a){var t=a.payload,n=t.enabled,i=t.distance;void 0!==n&&(e.autoPlay=n),void 0!==i&&(e.autoPlayDistance=i)},updateCalculatedData:function(e,a){var t=a.payload,n=t.position,i=t.heading,c=t.currentTime,r=Z(n);e.pages.forEach((function(a){var t=e.calculatedData[a.pageid],n=null!==t&&void 0!==t?t:{},o=n.closestPoint,l=n.lastUpdateTime;if(!t||!o.distance||o.distance<5e3&&o.distance>0||o.distance<1e4&&l+2e3>c||l+4e3<c){var u,d=null===(u=a.coordinates)||void 0===u?void 0:u.map((function(e){var a,t=(a=e)?{latitude:a.lat,longitude:a.lon}:void 0,n=r&&Object(Y.getDistance)(r,t),c=r&&Math.round(Object(Y.getRhumbLineBearing)(r,t)),o=(((null!==c&&void 0!==c?c:0)-(null!==i&&void 0!==i?i:0))%360+540)%360-180;return{coord:e,distance:n,bearing:c,headingDifference:o,isInFront:o>=-45&&o<=45}})).sort((function(e,a){return e.distance-a.distance}))[0];d&&(e.calculatedData[a.pageid]=Object(s.a)(Object(s.a)({},e.calculatedData[a.pageid]),{},{closestPoint:d,lastUpdateTime:c}))}}))}}}),ee=$.actions,ae=ee.setEnabled,te=ee.setEdition,ne=ee.receivePages,ie=ee.removePages,ce=ee.addToPlayQueue,re=ee.markAsRead,oe=(ee.setSearchRadius,ee.updatePageRatings,ee.setAutoPlay),se=ee.updateCalculatedData;function le(e,a){var t=(null===e||void 0===e?void 0:e.closestPoint)&&(null===a||void 0===a?void 0:a.closestPoint)?e.closestPoint.distance-a.closestPoint.distance:0;return 0===t&&(t=e.page.title.localeCompare(a.page.title)),0===t&&(t=e.page.pageid-a.page.pageid),t}var ue=function(e,a,t){return function(){var n=Object(W.a)(L.a.mark((function n(i,c){var r,o,s;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=c(),o=pe(r),n.next=4,G.getPagesByGeoLocation(o,e,a,t);case 4:(s=n.sent)&&i(ne({data:s,searchPosition:[e,a],searchRadius:t,searchTime:(new Date).getTime()}));case 6:case"end":return n.stop()}}),n)})));return function(e,a){return n.apply(this,arguments)}}()},de=function(e){return e.wikipedia.isEnabled},pe=function(e){return e.wikipedia.edition},be=function(e){return e.wikipedia.availableEditions},ve=function(e){return e.wikipedia.searchRadius},ge=function(e){return e.wikipedia.lastSearchPosition},je=function(e){return e.wikipedia.lastSearchRadius},fe=function(e){return e.wikipedia.lastSearchTime},he=function(e){return e.wikipedia.autoPlay},me=function(e){return e.wikipedia.autoPlayDistance},Oe=Object(K.a)((function(e){var a,t,n;return{pages:null===(a=e.wikipedia)||void 0===a?void 0:a.pages,calculatedData:null===(t=e.wikipedia)||void 0===t?void 0:t.calculatedData,playQueue:null===(n=e.wikipedia)||void 0===n?void 0:n.playQueue}}),(function(e){var a=e.pages,t=e.playQueue,n=e.calculatedData,i=null===a||void 0===a?void 0:a.map((function(e){var a;return{page:e,closestPoint:(null!==(a=n[e.pageid])&&void 0!==a?a:{}).closestPoint,isInPlayQueue:t.includes(e.pageid),isReading:t[0]===e.pageid}})).sort(le);return[].concat(Object(A.a)(i.filter((function(e){var a;return null===(a=e.closestPoint)||void 0===a?void 0:a.isInFront}))),Object(A.a)(i.filter((function(e){var a;return!(null===(a=e.closestPoint)||void 0===a?void 0:a.isInFront)}))))})),ye=Object(K.a)((function(e){var a;return{pages:Oe(e),playQueue:null===(a=e.wikipedia)||void 0===a?void 0:a.playQueue}}),(function(e){var a=e.pages;return e.playQueue.map((function(e){return a.find((function(a){return a.page.pageid===e}))}))})),xe=Object(K.a)((function(e){var a,t,n,i;return{position:null===(a=e.simdata)||void 0===a?void 0:a.position,heading:null===(t=e.simdata)||void 0===t?void 0:t.heading,speed:null===(n=e.simdata)||void 0===n?void 0:n.airspeed,searchRadius:null===(i=e.wikipedia)||void 0===i?void 0:i.searchRadius}}),(function(e){var a=e.position,t=e.heading,n=e.searchRadius,i=e.speed;return a?i>50?Object(Y.computeDestinationPoint)(Z(a),n,t):Z(a):void 0})),ke=$.reducer,Se=[{name:"OpenStreetMap",type:"tileServer",tileServer:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors'},{name:"Stamen toner",type:"tileServer",tileServer:"http://{s}.tile.stamen.com/toner/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank\' href="http://maps.stamen.com">Stamen</a>'},{name:"Stamen terrain",type:"tileServer",tileServer:"http://{s}.tile.stamen.com/terrain/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank\' href="http://maps.stamen.com">Stamen</a>'},{name:"Stamen watercolor",type:"tileServer",tileServer:"http://{s}.tile.stamen.com/watercolor/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank\' href="http://maps.stamen.com">Stamen</a>'},{name:"Carto Dark",type:"tileServer",tileServer:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank\' href="https://carto.com">Carto</a>'},{name:"Carto (voyager)",type:"tileServer",tileServer:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",attribution:'&copy; <a target="_blank" href="https://osm.org/copyright">OpenStreetMap</a> <a target="_blank" href="https://carto.com/">Carto</a>',subdomains:"abcd"},{name:"Airspace data (OpenAIP)",type:"tileServer",tileServer:"https://{s}.tile.maps.openaip.net/geowebcache/service/tms/1.0.0/openaip_basemap@EPSG%3A900913@png/{z}/{x}/{y}.png",attribution:'"Airspace data: <a target="_blank" href="https://www.openaip.net/">OpenAIP</a>',subdomains:"12"}],Pe=Object(b.b)({name:"map",initialState:{isFollowing:!0,currentMap:"OpenStreetMap",availableMaps:Se,visualizeSearchRadius:!0,courseLine:!1},reducers:{setCurrentMap:function(e,a){e.currentMap=a.payload},setIsFollowing:function(e,a){e.isFollowing=a.payload},setVisualizeSearchRadius:function(e,a){e.visualizeSearchRadius=a.payload},setShowCourseLine:function(e,a){e.courseLine=a.payload}}}),_e=Pe.actions,we=(_e.updateMsfs,_e.setCurrentMap),ze=_e.setIsFollowing,Ne=_e.setVisualizeSearchRadius,Ce=_e.setShowCourseLine,Ee=function(e){return e.map.availableMaps.find((function(a){return a.name===e.map.currentMap}))},Fe=function(e){return e.map.availableMaps},De=function(e){return e.map.isFollowing},Re=function(e){return e.map.visualizeSearchRadius},Ie=function(e){return e.map.courseLine};var Me=Object(K.a)((function(e){var a,t;return{position:null===(a=h(e))||void 0===a?void 0:a.position,heading:null===(t=h(e))||void 0===t?void 0:t.heading}}),(function(e){var a=e.position,t=e.heading;return a?[a].concat(Object(A.a)(function(e,a){var t=Z(e);return[100,200,300,400,500].map((function(e){return Object(Y.computeDestinationPoint)(t,1e3*e,a)})).map(X).filter((function(e){return e}))}(a,t))):void 0})),Ve=Pe.reducer;var Qe=n.memo((function(e){var a=e.expanded,t=e.toggleExpanded,n=e.changeMap,i=e.currentMap,c=e.availableMaps,r=e.changeEdition,o=e.edition,s=e.availableEditions,l=e.changeVoice,d=e.voice,p=e.availableVoices,b=e.autoPlay,v=e.autoPlayDistance,g=e.changeAutoPlay,j=e.visualizeSearchRadius,f=e.changeVisualizeSearchRadius,h=e.courseLine,m=e.changeShowCourseLine;return Object(O.jsxs)("div",{className:_.a.main,children:[Object(O.jsxs)("button",{className:"".concat(_.a.preferenceButton).concat(a?" ".concat(_.a.expanded):""),onClick:t,children:[Object(O.jsx)(u.b,{size:"100%"}),Object(O.jsx)(u.a,{className:_.a.caret})]}),a&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:_.a.preference,children:[Object(O.jsx)("label",{htmlFor:"mapserver",children:"Map"}),Object(O.jsx)("select",{id:"mapserver",onChange:n,value:i.name,children:c.map((function(e){var a=e.name;return Object(O.jsx)("option",{value:a,children:a},a)}))})]}),Object(O.jsxs)("div",{className:_.a.preference,children:[Object(O.jsx)("label",{htmlFor:"wikipedia-edition",children:"Wikipedia Edition"}),Object(O.jsx)("select",{id:"wikipedia-edition",onChange:r,value:o,children:s.map((function(e){return Object(O.jsx)("option",{value:e,children:S.a.getName(e)?"".concat(S.a.getName(e)," (").concat(e,")"):e},e)}))})]}),Object(O.jsxs)("div",{className:_.a.preference,children:[Object(O.jsx)("label",{htmlFor:"visualizeSearchRadius",children:"Visualize search radius on map"}),Object(O.jsx)("input",{id:"visualizeSearchRadius",type:"checkbox",checked:j,onChange:function(e){return f(e.target.checked)}})]}),Object(O.jsxs)("div",{className:_.a.preference,children:[Object(O.jsx)("label",{htmlFor:"showCourseLine",children:"Show course line"}),Object(O.jsx)("input",{id:"showCourseLine",type:"checkbox",checked:h,onChange:function(e){return m(e.target.checked)}})]}),Object(O.jsxs)("div",{className:_.a.preference,children:[Object(O.jsx)("label",{htmlFor:"voice",children:"Voice"}),Object(O.jsx)("select",{id:"voice",onChange:l,value:d,children:p.map((function(e){return Object(O.jsx)("option",{value:e,children:e},e)}))})]}),Object(O.jsxs)("div",{className:_.a.preference,children:[Object(O.jsx)("label",{htmlFor:"autoPlay",children:"Enable automatically reading articles"}),Object(O.jsx)("input",{id:"autoPlay",type:"checkbox",checked:b,onChange:function(e){return g(e.target.checked)}})]}),b&&Object(O.jsxs)("div",{className:_.a.preference,children:[Object(O.jsx)("label",{htmlFor:"autoPlayDistance",children:"Read articles when they are in front and within distance"}),Object(O.jsx)("select",{id:"autoPlayDistance",onChange:function(e){return g(void 0,parseInt(e.target.value,10))},value:v,children:[100,500,1e3,2e3,5e3,1e4,2e4].map((function(e){return Object(O.jsx)("option",{value:e,children:"".concat(e," m")},e)}))})]})]})]})}));function Le(){var e={edition:Object(l.d)(pe),availableEditions:Object(l.d)(be),voice:Object(l.d)(D),availableVoices:Object(l.d)(R),currentMap:Object(l.d)(Ee),availableMaps:Object(l.d)(Fe),autoPlay:Object(l.d)(he),autoPlayDistance:Object(l.d)(me),visualizeSearchRadius:Object(l.d)(Re),courseLine:Object(l.d)(Ie)},a=e.edition,t=e.availableEditions,i=e.voice,c=e.availableVoices,r=e.currentMap,o=e.availableMaps,s=e.autoPlay,u=e.autoPlayDistance,d=e.visualizeSearchRadius,p=e.courseLine;!function(){var e=Object(l.c)();Object(n.useEffect)((function(){Object(l.b)((function(){localStorage["wikipedia-enabled"]&&e(ae(JSON.parse(localStorage["wikipedia-enabled"]))),localStorage["wikipedia-edition"]&&e(te(localStorage["wikipedia-edition"])),localStorage.voice&&e(C(localStorage.voice)),localStorage.currentMap&&e(we(localStorage.currentMap)),localStorage.autoPlay&&e(oe({enabled:JSON.parse(localStorage.autoPlay)})),localStorage.autoPlayDistance&&e(oe({distance:JSON.parse(localStorage.autoPlayDistance)})),localStorage.visualizeSearchRadius&&e(Ne(JSON.parse(localStorage.visualizeSearchRadius))),localStorage.courseLine&&e(Ce(JSON.parse(localStorage.courseLine)))}))}),[e])}(),function(){var e=Object(l.c)();Object(n.useEffect)((function(){var a=function(){var a=window.speechSynthesis.getVoices();e(E(a.map((function(e){return e.name}))))};return a(),window.speechSynthesis.addEventListener("voiceschanged",a),function(){return window.speechSynthesis.removeEventListener("voiceschanged",a)}}),[e])}();var b=function(){var e=Object(l.c)();return{changeEdition:Object(n.useCallback)((function(a){localStorage["wikipedia-edition"]=a.target.value,e(te(a.target.value))}),[e]),changeVoice:Object(n.useCallback)((function(a){localStorage.voice=a.target.value,e(C(a.target.value))}),[e]),changeMap:Object(n.useCallback)((function(a){localStorage.currentMap=a.target.value,e(we(a.target.value))}),[e]),changeAutoPlay:Object(n.useCallback)((function(a,t){void 0!==a&&(localStorage.autoPlay=JSON.stringify(a)),void 0!==t&&(localStorage.autoPlayDistance=JSON.stringify(t)),e(oe({enabled:a,distance:t}))}),[e]),changeVisualizeSearchRadius:Object(n.useCallback)((function(a){localStorage.visualizeSearchRadius=JSON.stringify(a),e(Ne(a))}),[e]),changeShowCourseLine:Object(n.useCallback)((function(a){localStorage.courseLine=JSON.stringify(a),e(Ce(a))}),[e])}}(),v=b.changeEdition,g=b.changeVoice,j=b.changeMap,f=b.changeAutoPlay,h=b.changeVisualizeSearchRadius,m=b.changeShowCourseLine,y=function(){var e=Object(n.useState)(!1),a=Object(w.a)(e,2),t=a[0],i=a[1];return{toggleExpanded:Object(n.useCallback)((function(e){i(!t)}),[t]),expanded:t}}(),x=y.toggleExpanded,k=y.expanded;return Object(O.jsx)(Qe,{expanded:k,toggleExpanded:x,changeMap:j,currentMap:r,availableMaps:o,changeEdition:v,edition:a,availableEditions:t,changeVoice:g,voice:i,availableVoices:c,autoPlay:s,autoPlayDistance:u,changeAutoPlay:f,visualizeSearchRadius:d,changeVisualizeSearchRadius:h,courseLine:p,changeShowCourseLine:m})}var We=t(123),Ae=t(53),Te=t.n(Ae),Be=n.memo((function(e){var a=e.isFollowing,t=e.toggleFollow,n=e.isWikipediaEnabled,i=e.toggleIsEnabled;return Object(O.jsxs)("div",{className:Te.a.main,children:[Object(O.jsx)("button",{className:"".concat(a?Te.a.active:""),onClick:t,children:Object(O.jsx)(We.a,{size:"100%"})}),Object(O.jsx)("button",{className:"".concat(Te.a.gap," ").concat(n?Te.a.active:""),onClick:i,children:Object(O.jsx)(u.g,{size:"100%"})})]})}));function Je(){var e=Object(l.c)(),a=Object(l.d)(De),t=Object(n.useCallback)((function(){e(ze(!a))}),[e,a]),i=Object(l.d)(de),c=Object(n.useCallback)((function(){localStorage["wikipedia-enabled"]=JSON.stringify(!i),e(ae(!i))}),[e,i]);return Object(O.jsx)(Be,{isFollowing:a,toggleFollow:t,isWikipediaEnabled:i,toggleIsEnabled:c})}var qe=t(124),Ue=t.n(qe),Ge=t(125);function He(e){var a=Object(l.c)(),t=Object(n.useCallback)((function(){a(F(!e))}),[a,e]),i=Object(n.useCallback)((function(){a((function(e,a){var t,n=a(),i=ye(n),c=Object(V.a)(i).slice(1).sort(le);e($.actions.advancePlayQueue({nextPageId:null===(t=c[0])||void 0===t?void 0:t.pageid}))}))}),[a]);return{togglePlaybackState:t,next:i}}var Ke=t(25),Ye=t.n(Ke),Ze=function(e){var a=e.togglePlaybackState,t=e.isPlaying,n=e.next;return Object(O.jsxs)("div",{className:Ye.a.controls,children:[Object(O.jsxs)("button",{className:"".concat(Ye.a.btn," ").concat(Ye.a.gap),onClick:a,children:[t&&Object(O.jsx)(u.c,{size:"100%"}),!t&&Object(O.jsx)(u.e,{size:"100%"})]}),Object(O.jsx)("button",{className:"".concat(Ye.a.btn),onClick:n,children:Object(O.jsx)(u.f,{size:"100%"})})]})},Xe=i.a.memo(Ze),$e=function(e){var a=e.page,t=e.togglePlaybackState,n=e.isPlaying,i=e.next,c=e.playQueue;return Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("div",{className:Ye.a.player,children:[Object(O.jsxs)("div",{className:Ye.a.info,children:[!a&&"No articles in reading queue",a&&"".concat(c.length," articles in reading queue")]}),Object(O.jsx)(Xe,{isPlaying:n,togglePlaybackState:t,next:i})]})})},ea=i.a.memo($e);function aa(){var e=function(){var e,a=Object(l.d)(ye),t=null!==(e=a[0])&&void 0!==e?e:{},n=t.page,i=null!==n&&void 0!==n?n:{};return{page:n,closestPoint:t.closestPoint,isInPlayQueue:t.isInPlayQueue,isInFront:t.isInFront,title:i.title,extract:i.extract,voice:Object(l.d)(D),isPlaying:Object(l.d)(I),playQueue:a}}(),a=e.page,t=e.title,i=e.extract,c=e.voice,r=e.isPlaying,o=e.playQueue,s=He(r),u=s.togglePlaybackState,d=s.next;return function(e,a,t,i,c){Object(n.useEffect)((function(){e||speechSynthesis.cancel()}),[e]),Object(n.useEffect)((function(){if(e&&a&&t&&c){var n="".concat(a,"\n\n").concat(t?Object(Ge.decode)(Ue()(t)):""),r=new SpeechSynthesisUtterance(n);return r.voice=speechSynthesis.getVoices().find((function(e){return e.name===c})),r.onend=function(){i()},speechSynthesis.speak(r),function(){r.onend=null,speechSynthesis.cancel()}}}),[e,a,t,i,c])}(r,t,i,d,c),function(e,a){Object(n.useEffect)((function(){var t=function(t){"n"===t.key?e():" "===t.key&&a()};return document.addEventListener("keypress",t),function(){return document.removeEventListener("keypress",t)}}),[e,a])}(d,u),Object(O.jsx)(ea,{page:a,togglePlaybackState:u,isPlaying:r,next:d,playQueue:o})}var ta=t(129),na=t(126);function ia(){var e=Object(l.c)();Object(n.useEffect)((function(){var a=setInterval((function(){e((function(e,a){var t,n=a(),i=Oe(n),c=null===(t=ye(n))||void 0===t?void 0:t.map((function(e){var a;return null===(a=e.page)||void 0===a?void 0:a.pageid})),r=i.filter((function(e,a){var t,n,i,r;return a>=100&&!(null===c||void 0===c?void 0:c.includes(null===(t=e.page)||void 0===t?void 0:t.pageid))||(null===c||void 0===c?void 0:c.indexOf(null===(n=e.page)||void 0===n?void 0:n.pageid))>=80||!(null===e||void 0===e||null===(i=e.closestPoint)||void 0===i?void 0:i.isInFront)&&(null===e||void 0===e||null===(r=e.closestPoint)||void 0===r?void 0:r.distance)>4e4}));e(ie({pageids:r.map((function(e){var a;return null===(a=e.page)||void 0===a?void 0:a.pageid}))}))}))}),3e4);return function(){clearInterval(a)}}),[e])}var ca=t(127),ra=t(45),oa=t.n(ra),sa=t(51),la=t(128),ua=t(87),da=t.n(ua);function pa(e){var a=e.point,t=null!==a&&void 0!==a?a:{},i=t.distance,c=t.headingDifference,r=Object(n.useMemo)((function(){return{transform:"perspective(64px) rotate3d(1, 0, 0, 55deg) rotate(".concat(null!==c&&void 0!==c?c:0,"deg)")}}),[c]),o=Object(n.useMemo)((function(){return function(e){return 0===e||e?e<5e3?"".concat(Math.round(e)," m"):"".concat(e<99999?(e/1e3).toFixed(1):Math.round(e/1e3)," km"):""}(i)}),[i]);return a?Object(O.jsxs)("div",{className:da.a.distance,children:[Object(O.jsx)(la.a,{className:da.a.arrow,size:32,fill:(null===a||void 0===a?void 0:a.isInFront)?"#2F2":"#AAA",stroke:"black",strokeWidth:1,style:r}),Object(O.jsx)("span",{children:o})]}):null}function ba(e){var a=e.page;return a.extract?Object(ca.a)(a.extract):null}function va(e){var a,t=e.page;return(null===t||void 0===t||null===(a=t.thumbnail)||void 0===a?void 0:a.source)?Object(O.jsx)("a",{href:t.thumbnail.source,target:"_blank",rel:"noopener noreferrer",children:Object(O.jsx)("img",{src:t.thumbnail.source,alt:t.title})}):null}var ga=function(e){var a=e.page,t=e.closestPoint,i=e.isInPlayQueue,c=Object(l.c)(),r=function(e){var a=Object(l.d)(pe);return e?"https://".concat(a,".wikipedia.org/?curid=").concat(e.pageid):null}(a),o=a.pageid,s=Object(n.useCallback)((function(){c(ce({pageid:o}))}),[c,o]),u=Object(n.useCallback)((function(){c(re({pageid:o}))}),[c,o]);return Object(O.jsxs)("article",{className:oa.a.page,children:[Object(O.jsxs)("div",{className:oa.a.title,children:[a.isReading&&Object(O.jsx)(sa.a,{className:oa.a.speaker,size:32,stroke:"black",strokeWidth:1,color:"#FFF"}),Object(O.jsx)("a",{href:r,target:"_blank",rel:"noreferrer",children:a.title}),Object(O.jsx)(pa,{point:t}),Object(O.jsx)(va,{page:a})]}),Object(O.jsx)("div",{className:oa.a.text,children:Object(O.jsx)(ba,{page:a})}),!i&&Object(O.jsxs)("div",{className:oa.a.buttonBar,children:[Object(O.jsx)("button",{type:"button",onClick:s,children:Object(O.jsx)(sa.a,{size:"100%"})}),Object(O.jsx)("button",{type:"button",onClick:u,children:Object(O.jsx)(ta.a,{size:"100%"})})]})]})},ja=i.a.memo(ga),fa=t(130),ha=t.n(fa);function ma(){var e,a=Object(l.d)(de),t=null!==(e=Object(l.d)(ye)[0])&&void 0!==e?e:{},n=t.page,i=t.closestPoint,c=t.isInPlayQueue,r=t.isInFront;return a?Object(O.jsxs)("div",{className:ha.a.ttsPanel,children:[Object(O.jsx)(aa,{}),n&&Object(O.jsx)(ja,{page:n,closestPoint:i,isInPlayQueue:c,isInFront:r})]}):null}var Oa=t(131),ya=t.n(Oa);function xa(){return Object(O.jsxs)("div",{className:ya.a.ui,children:[Object(O.jsx)(k,{}),Object(O.jsx)(Le,{}),Object(O.jsx)(Je,{}),Object(O.jsx)(ma,{})]})}var ka=t(39),Sa=t(69),Pa=t.n(Sa),_a=t(48),wa=t.n(_a);function za(e){var a=e.isReading;return Object(O.jsxs)(O.Fragment,{children:[!a&&Object(O.jsx)(u.g,{size:32}),a&&Object(O.jsx)(sa.a,{className:wa.a.speaker,size:32,stroke:"black",strokeWidth:1,color:"#FFF"})]})}var Na=n.memo((function(e){var a,t=e.page,n=e.isInPlayQueue,i=e.isCurrentPage,c=e.isPlaying,r=t.pageid,o=t.coordinates,s=wa.a.marker;return i?s+=" ".concat(wa.a.current):n&&(s+=" ".concat(wa.a.queued)),null!==(a=null===o||void 0===o?void 0:o.map((function(e,a){return Object(O.jsx)(Pa.a,{position:e,icon:Object(O.jsx)("div",{className:wa.a.container,children:Object(O.jsx)("div",{className:s,children:Object(O.jsx)(za,{isReading:c&&i})})})},"".concat(r,"-").concat(a))})))&&void 0!==a?a:null}));function Ca(){var e,a=Object(l.d)(Oe),t=null===(e=Object(l.d)(ye))||void 0===e?void 0:e[0],i=Object(l.d)(I);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e4,a=Object(l.c)(),t=Object(l.d)(de),i=Object(l.d)(ge),c=Object(l.d)(je),r=Object(l.d)(fe),o=Object(l.d)(ve),s=Object(l.d)(xe);Object(n.useEffect)((function(){var n,l;if(s&&t){var u=[null!==(n=s.latitude)&&void 0!==n?n:0,null!==(l=s.longitude)&&void 0!==l?l:0],d=!i||Object(Y.getDistance)(s,{latitude:i[0],longitude:i[1]})>100,p=o!==c,b=(new Date).getTime()-r;(d&&b>e||p)&&a(ue(u[0],u[1],o))}}),[a,t,s,i,o,c,r,e])}(),ia(),function(){var e=Object(l.c)(),a=Object(l.d)(he),t=Object(l.d)(me),i=Object(l.d)(Oe);Object(n.useEffect)((function(){if(a&&i){var n,c=i.filter((function(e){var a;return(null===(a=e.closestPoint)||void 0===a?void 0:a.distance)<t&&!e.isInPlayQueue})),r=Object(na.a)(c);try{for(r.s();!(n=r.n()).done;){var o=n.value;e(ce({pageid:o.page.pageid}))}}catch(s){r.e(s)}finally{r.f()}}}),[e,a,t,i])}(),function(){var e=Object(l.c)(),a=Object(l.e)();Object(n.useEffect)((function(){var t=setInterval((function(){var t=h(a.getState()),n=t.position,i=t.heading;e(se({position:n,heading:i,currentTime:(new Date).getTime()}))}),250);return function(){clearInterval(t)}}),[e,a])}(),null===a||void 0===a?void 0:a.map((function(e){var a,n,c;return Object(O.jsx)(Na,{page:null===e||void 0===e?void 0:e.page,isInPlayQueue:null===e||void 0===e?void 0:e.isInPlayQueue,isPlaying:i,isCurrentPage:(null===t||void 0===t||null===(n=t.page)||void 0===n?void 0:n.pageid)===(null===e||void 0===e||null===(c=e.page)||void 0===c?void 0:c.pageid)},null===e||void 0===e||null===(a=e.page)||void 0===a?void 0:a.pageid)}))}var Ea=t(120),Fa=t(133),Da=n.memo((function(e){var a=e.currentMap,t='&copy; <a target="_blank" href="https://en.wikipedia.org">Wikipedia</a>, '+"".concat(a.attribution,", ")+'&copy; <a target="_blank" href="https://react-leaflet.js.org/">react-leaflet</a>, '+'<a target="_blank" href="https://github.com/kivle/msfs-map">MSFS-map</a> v'.concat(Fa.a),n=null,i=a.subdomains?{subdomains:a.subdomains}:{};return"tileServer"===a.type&&(n=Object(O.jsx)(Ea.a,Object(s.a)({attribution:t,url:a.tileServer},i),a.tileServer)),n})),Ra=t(119);function Ia(){var e=Object(l.d)(Me);return e?Object(O.jsx)(Ra.a,{positions:e,pathOptions:{strokeWidth:1,color:"gray",opacity:.5}}):null}var Ma=t(117);function Va(){var e=Object(l.d)(ve),a=X(Object(l.d)(xe));return Object(O.jsx)(Ma.a,{center:a,radius:e,color:"blue",fill:!1})}var Qa=t(134),La=t.n(Qa);function Wa(){var e=Object(l.d)(h),a=e.position,t=e.heading,n=Object(O.jsx)("div",{className:La.a.plane,style:{transform:"rotate(".concat(t-90,"deg)")},children:Object(O.jsx)(u.d,{size:32,stroke:"white",strokeWidth:"40",fill:"#44F"})});return Object(O.jsx)(Pa.a,{position:a,icon:n})}function Aa(){var e=Object(ka.a)(),a=Object(l.d)(h).position,t=Object(l.d)(Ee),i=Object(l.d)(De),c=Object(l.d)(de),r=Object(l.d)(Re),o=Object(l.d)(Ie);return Object(n.useEffect)((function(){i&&a&&e.setView(a,e.getZoom(),{animate:!0})}),[e,i,a]),Object(n.useEffect)((function(){e.invalidateSize()}),[e,c]),Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(Da,{currentMap:t}),!!c&&Object(O.jsx)(Ca,{}),!!a&&!!c&&!!r&&Object(O.jsx)(Va,{}),!!a&&!!o&&Object(O.jsx)(Ia,{}),!!a&&Object(O.jsx)(Wa,{})]})}var Ta=t(135),Ba=t.n(Ta);function Ja(){return Object(O.jsxs)("div",{className:Ba.a.map,children:[Object(O.jsx)(xa,{}),Object(O.jsx)(o.a,{center:[51.505,-.09],zoom:13,children:Object(O.jsx)(Aa,{})})]})}t(239);var qa=t(54),Ua=t.n(qa);function Ga(){var e=Object(l.d)(Oe),a=null===e||void 0===e?void 0:e.filter((function(e){return!e.isInPlayQueue})),t=(null===a||void 0===a?void 0:a.length)>20?null===a||void 0===a?void 0:a.slice(0,20):a;return Object(O.jsx)("div",{className:Ua.a.sidebar,children:Object(O.jsxs)("div",{children:[!(null===a||void 0===a?void 0:a.length)&&Object(O.jsx)("div",{className:Ua.a.status,children:"No pages found. Results will show up here as you fly around the world."}),!!(null===a||void 0===a?void 0:a.length)&&Object(O.jsxs)("div",{className:Ua.a.status,children:[null===a||void 0===a?void 0:a.length," pages found."]}),null===t||void 0===t?void 0:t.map((function(e){var a=e.page,t=e.closestPoint,n=e.isInPlayQueue;return Object(O.jsx)("div",{className:Ua.a.pageContainer,children:Object(O.jsx)(ja,{page:a,closestPoint:t,isInPlayQueue:n})},a.pageid)}))]})})}var Ha=function(){var e=Object(l.d)(de);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ws://localhost:9000/ws",a=Object(l.e)(),t=Object(l.c)();Object(n.useEffect)((function(){var n=void 0,i=!1,c=void 0;return function r(){(n=new WebSocket(e)).onmessage=function(e){var n,i;(null===(n=a.getState())||void 0===n||null===(i=n.simdata)||void 0===i?void 0:i.connected)||t(f(!0));var c=JSON.parse(e.data);c.latitude>=0&&c.latitude<.015&&c.longitude>=0&&c.longitude<.015||t(j(c))},n.onerror=function(e){console.debug(e)},n.onclose=function(e){t(f(!1)),i||(c=setTimeout(r,2e3))}}(),function(){try{clearTimeout(c),i=!0,n.close(),n=void 0,t(f(!1))}catch(e){}}}),[t,e,a])}(),Object(O.jsxs)("div",{className:"App",children:[Object(O.jsx)(Ja,{}),e&&Object(O.jsx)(Ga,{})]})},Ka=Object(b.a)({reducer:{map:Ve,simdata:m,wikipedia:ke,tts:M}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(240),t(5);window._store=Ka,r.a.render(Object(O.jsx)(i.a.StrictMode,{children:Object(O.jsx)(l.a,{store:Ka,children:Object(O.jsx)(Ha,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},25:function(e,a,t){e.exports={player:"View_player__2u6ia",controls:"View_controls__1lpJp",info:"View_info__1AUmh"}},45:function(e,a,t){e.exports={page:"WikipediaPage_page__3j8zU",title:"WikipediaPage_title__1gae6",text:"WikipediaPage_text__3ztTt",buttonBar:"WikipediaPage_buttonBar__YD5uL",speaker:"WikipediaPage_speaker__nPyCJ"}},48:function(e,a,t){e.exports={container:"WikipediaMarker_container__3Rt_r",marker:"WikipediaMarker_marker__5fM6z",current:"WikipediaMarker_current__sVu6_",queued:"WikipediaMarker_queued__3gDRl",speaker:"WikipediaMarker_speaker__DnvOa",pulse:"WikipediaMarker_pulse__1k_If"}},53:function(e,a,t){e.exports={main:"ButtonBar_main__3br2_",active:"ButtonBar_active__3Biec",gap:"ButtonBar_gap__2g3HT"}},54:function(e,a,t){e.exports={sidebar:"Sidebar_sidebar__1kXOI",status:"Sidebar_status__fpfjB",pageContainer:"Sidebar_pageContainer__3NWwk"}},86:function(e,a,t){e.exports={main:"PlaneInfo_main__9z7SN",infoField:"PlaneInfo_infoField__3d4Nw"}},87:function(e,a,t){e.exports={distance:"DistanceVisualizer_distance__25YZl",arrow:"DistanceVisualizer_arrow__2OH0n"}}},[[241,1,2]]]);
//# sourceMappingURL=main.e33237d6.chunk.js.map