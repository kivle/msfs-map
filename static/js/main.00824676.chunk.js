(this["webpackJsonpmsfs-map"]=this["webpackJsonpmsfs-map"]||[]).push([[0],{174:function(e,t,a){},176:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(15),c=a.n(r),o=(a(99),a(77)),l=a(78),s=a(7),u=a(42),p=a.n(u),d=a(31),m=a(32);var g=Object(m.b)({name:"map",initialState:{plane:{position:void 0,altitude:0,heading:0,airspeed:0,vertical_speed:0,airspeed_true:0,flaps:0,trim:0,rudder_trim:0},zoom:13},reducers:{updateMsfs:function(e,t){var a=t.payload.msg;e.plane.position=[a.latitude,a.longitude],e.plane.altitude=a.altitude,e.plane.heading=a.heading,e.plane.airspeed=a.airspeed,e.plane.vertical_speed=a.vertical_speed,e.plane.airspeed_true=a.airspeed_true,e.plane.flaps=a.flaps,e.plane.trim=a.trim,e.plane.rudder_trim=a.rudder_trim},zoomChanged:function(e,t){e.zoom=t.payload}}}),f=g.actions,v=f.updateMsfs,h=f.zoomChanged,b=function(e){!function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ws://localhost:9000/ws",n=new WebSocket(a);n.onmessage=function(e){var a=JSON.parse(e.data);a.latitude>=0&&a.latitude<.015&&a.longitude>=0&&a.longitude<.015||t(a)},n.onerror=function(e){},n.onclose=function(i){try{n.close()}catch(r){}setTimeout((function(){return e(t,a)}),2e3)}}((function(t){e(v({msg:t}))}))},k=function(e){return e.map.plane.position},w=function(e){return e.map.zoom},y=function(e){return{altitude:e.map.plane.altitude,heading:e.map.plane.heading,airspeed:e.map.plane.airspeed,vertical_speed:e.map.plane.vertical_speed,airspeed_true:e.map.plane.airspeed_true,flaps:e.map.plane.flaps,trim:e.map.plane.trim,rudder_trim:e.map.plane.rudder_trim}},E=g.reducer,j=a(62),_=a.n(j);function O(){var e=Object(s.d)(y),t=e.airspeed,a=e.airspeed_true,i=e.altitude,r=e.heading,c=e.vertical_speed,o=e.flaps,l=e.trim,u=e.rudder_trim;return n.createElement("div",{className:_.a.main},n.createElement(x,{label:"Airspeed",value:"".concat(t," kt (").concat(a," kt)")}),n.createElement(x,{label:"Altitude",value:"".concat(i," ft")}),n.createElement(x,{label:"Heading",value:n.createElement(n.Fragment,null,n.createElement(d.a,{style:{transform:"rotate(".concat(r-90,"deg)")}})," ".concat(r,"\xb0"))}),n.createElement(x,{label:"V. speed",value:"".concat(c," ft/s")}),0!==parseFloat(o)&&n.createElement(x,{label:"Flaps",value:"".concat(o)}),0!==parseFloat(l)&&n.createElement(x,{label:"Trim",value:"".concat(l,"%")}),0!==parseFloat(u)&&n.createElement(x,{label:"R.Trim",value:"".concat(u,"%")}))}function x(e){var t=e.label,a=e.value;e.unit;return n.createElement("span",{className:_.a.infoField},n.createElement("label",null,t),n.createElement("span",null,a))}var z=a(88),S=a.n(z),P=a(89),V=a.n(P),N=a(90),F=a(45),C=a.n(F),W=a(12),B=a.n(W),L=a(28),M=a(63),q=a(29),A=a(30),G=new(function(){function e(){Object(q.a)(this,e)}return Object(A.a)(e,[{key:"getWikipediaApiUrl",value:function(e,t){var a=Object.keys(t).reduce((function(e,a){return e&&(e+="&"),"".concat(e).concat(encodeURIComponent(a),"=").concat(encodeURIComponent(t[a]))}),"");return"https://".concat(e,".wikipedia.org/w/api.php?").concat(a)}},{key:"getPagesByGeoLocation",value:function(){var e=Object(L.a)(B.a.mark((function e(t,a,n,i){var r,c,o,l;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={format:"json",action:"query",generator:"geosearch",ggslimit:20,ggsradius:i,ggscoord:a+"|"+n,origin:"*",prop:"extracts|pageimages|coordinates",exsentences:"10",exintro:!0,exlimit:20,pithumbsize:"400",imlimit:"10"},c=this.getWikipediaApiUrl(t,r),e.next=4,fetch(c);case 4:return o=e.sent,e.next=7,o.json();case 7:return l=e.sent,e.abrupt("return",l);case 9:case"end":return e.stop()}}),e,this)})));return function(t,a,n,i){return e.apply(this,arguments)}}()}]),e}()),I=new(function(){function e(t,a){Object(q.a)(this,e),this.api=t,this.storage=a,this.getPagesByGeoLocation=function(e,t){var a=0;return function(){var n=(new Date).getTime();if(!(n-a<t))return a=n,e.apply(void 0,arguments)}}(this.getPagesByGeoLocation.bind(this),1e4)}return Object(A.a)(e,[{key:"getPagesByGeoLocation",value:function(){var e=Object(L.a)(B.a.mark((function e(t,a,n,i){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.getPagesByGeoLocation(t,a,n,i);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,a,n,i){return e.apply(this,arguments)}}()}]),e}())(G,window.localStorage);var J=Object(m.b)({name:"wikipedia",initialState:{edition:"en",availableEditions:["en","ceb","sv","de","fr","nl","ru","it","es","pl","war","vi","ja","zh","arz","ar","uk","pt","fa","ca","sr","id","no","ko","fi","hu","cs","sh","ro","zh-min-nan","tr","eu","ms","ce","eo","he","hy","bg","da","azb","sk","kk","min","hr","et","lt","be","el","simple","az","sl","gl","ur","nn","tt","hi","ka","th","uz","la","cy","ta","vo","mk","ast","lv","zh-yue","tg","bn","af","mg","oc","bs","sq","ky","nds","new","be-tarask","ml","te","br","tl","vec","pms","mr","su","ht","sw","lb","jv","pnb","ba","ga","szl","is","my","sco","fy","cv","lmo","wuu","an","pa","ne","diq","ku","yo","bar","io","gu","ckb","als","kn","scn","bpy","qu","ia","mn","bat-smg","si","nv","or","cdo","ilo","gd","xmf","yi","am","nap","bug","wa","sd","hsb","mai","fo","map-bms","mzn","li","sah","eml","os","ps","sa","frr","bcl","zh-classical","ace","mrj","mhr","avk","hif","gor","hak","roa-tara","pam","hyw","km","nso","rue","crh","se","bh","as","shn","vls","mi","nds-nl","nah","sc","vep","gan","myv","sn","ab","glk","bo","lrc","co","so","tk","fiu-vro","csb","ha","kv","ie","gv","udm","pcd","ay","kab","zea","sat","nrm","ug","lij","zu","kw","frp","lez","ban","stq","lfn","gn","mwl","gom","rm","mt","lo","lad","koi","fur","olo","ang","dty","dsb","bjn","ext","ln","cbk-zam","dv","ksh","tyv","ary","gag","pfl","pag","pi","av","awa","haw","bxr","xal","krc","pap","za","pdc","rw","kaa","szy","arc","to","nov","jam","tpi","kbp","kbd","ig","inh","na","tet","wo","tcy","ki","atj","jbo","roa-rup","bi","lbe","kg","ty","lg","mdf","fj","srn","xh","gcr","ltg","lld","chr","ak","om","sm","kl","got","pih","st","cu","ny","nqo","tn","tw","ts","rmy","bm","mnw","chy","rn","tum","ss","ch","iu","pnt","ks","ady","ve","ee","ik","ff","sg","dz","ti","cr","din","ng","cho","kj","mh","ho","ii","aa","mus","hz","kr"],currentVoice:void 0,availableVoices:[],currentPage:void 0,pages:[],pagesViewed:[]},reducers:{addPages:function(e,t){var a,n=t.payload.data,i=(n=void 0===n?{}:n).query,r=(i=void 0===i?{}:i).pages;if(r){var c=Object.keys(r).reduce((function(e,t){return e.push(r[t]),e}),[]).filter((function(t){var a,n,i;return(null===t||void 0===t||null===(a=t.extract)||void 0===a?void 0:a.length)>100&&(!!(i=null===t||void 0===t?void 0:t.extract)&&i.length>100&&(i.match(/\./g)||[]).length>1)&&(null===t||void 0===t||null===(n=t.coordinates)||void 0===n?void 0:n.length)>0&&!e.pages.some((function(e){return t.pageid===e.pageid}))&&!e.pagesViewed.some((function(e){return t.pageid===e}))}));(a=e.pages).push.apply(a,Object(M.a)(c)),c.length&&void 0===e.currentPage&&(e.currentPage=c[0].pageid)}},nextPage:function(e){if(void 0!==e.currentPage){e.pages=e.pages.filter((function(t){return t.pageid!==e.currentPage})),e.pagesViewed.push(e.currentPage);for(var t=function(){var t=Math.min.apply(Math,Object(M.a)(e.pages.map((function(e){return e.extract.length})))),a=e.pages.find((function(e){return e.extract.length===t}));e.pages=e.pages.filter((function(e){return e.pageid!==a.pageid}))};e.pages.length>10;)t()}var a=e.pages.sort((function(e,t){var a,n;return(null===t||void 0===t||null===(a=t.extract)||void 0===a?void 0:a.length)-(null===e||void 0===e||null===(n=e.extract)||void 0===n?void 0:n.length)})).find((function(t){return!e.pagesViewed.some((function(e){return t.pageid===e}))}));e.currentPage=a?a.pageid:void 0},setEdition:function(e,t){var a=t.payload;e.edition=a,e.currentPage=void 0,e.pages=[],e.pagesViewed=[]},setVoice:function(e,t){var a=t.payload;e.currentVoice=a},setAvailableVoices:function(e,t){var a=t.payload;e.availableVoices=a,e.voice&&!e.availableVoices.some((function(t){return t===e.voice}))&&(e.voice=void 0)}}}),U=J.actions,R=U.addPages,T=U.nextPage,Q=U.setEdition,X=U.setVoice,D=U.setAvailableVoices,H=function(e){return e.wikipedia.edition},Z=function(e){return e.wikipedia.availableEditions},$=function(e){return e.wikipedia.currentVoice},K=function(e){return e.wikipedia.availableVoices},Y=function(e){return e.wikipedia.pages},ee=function(e){return e.wikipedia.currentPage&&e.wikipedia.pages.find((function(t){return t.pageid===e.wikipedia.currentPage}))},te=J.reducer;function ae(e){var t=e.page;return t.extract?S()(t.extract):null}function ne(e){var t,a=e.page;return(null===a||void 0===a||null===(t=a.thumbnail)||void 0===t?void 0:t.source)?n.createElement("img",{src:a.thumbnail.source,alt:a.title}):null}function ie(){var e=Object(s.c)(),t=Object(s.d)(ee),a=Object(s.d)($),i=Object(n.useCallback)((function(){e(T())}),[e]);return Object(n.useEffect)((function(){if(t&&window.speechSynthesis){var e="".concat(t.title,"\n\n").concat(t.extract?Object(N.decode)(V()(t.extract)):""),n=new SpeechSynthesisUtterance(e);return n.voice=window.speechSynthesis.getVoices().find((function(e){return e.name===a})),n.onend=function(){i()},window.speechSynthesis.speak(n),function(){n.onend=null,speechSynthesis.cancel()}}}),[t,i,a]),t?n.createElement("div",{className:C.a.main},n.createElement("div",{className:C.a.title},n.createElement("div",null,t.title," ",n.createElement("button",{onClick:i},"Next")),n.createElement(ne,{page:t})),n.createElement("div",{className:C.a.text},n.createElement(ae,{page:t}))):null}var re=a(64),ce=a(46),oe=a.n(ce);function le(){var e=Object(s.c)(),t=Object(s.d)(H),a=Object(s.d)(Z),i=Object(s.d)($),r=Object(s.d)(K);Object(n.useEffect)((function(){Object(s.b)((function(){localStorage["wikipedia-edition"]&&e(Q(localStorage["wikipedia-edition"])),localStorage.voice&&e(X(localStorage.voice))}))}),[e]);var c=Object(n.useCallback)((function(t){localStorage["wikipedia-edition"]=t.target.value,e(Q(t.target.value))}),[e]),o=Object(n.useCallback)((function(t){localStorage.voice=t.target.value,e(X(t.target.value))}),[e]);return Object(n.useEffect)((function(){var t=function(){var t=window.speechSynthesis.getVoices();e(D(t.map((function(e){return e.name}))))};return t(),window.speechSynthesis.addEventListener("voiceschanged",t),function(){return window.speechSynthesis.removeEventListener("voiceschanged",t)}}),[e]),n.createElement("div",{className:oe.a.main},n.createElement("div",{className:oe.a.preference},n.createElement("label",{htmlFor:"wikipedia-edition"},"Wikipedia Edition"),n.createElement("select",{id:"wikipedia-edition",onChange:c,value:t},a.map((function(e){return n.createElement("option",{key:e,value:e},re.a.getName(e)?"".concat(re.a.getName(e)," (").concat(e,")"):e)})))),n.createElement("div",{className:oe.a.preference},n.createElement("label",{htmlFor:"voice"},"Voice"),n.createElement("select",{id:"voice",onChange:o,value:i},r.map((function(e){return n.createElement("option",{key:e,value:e},e)})))))}function se(){return n.createElement("div",null,n.createElement(O,null),n.createElement(ie,null),n.createElement(le,null))}var ue=a(91),pe=a.n(ue);function de(){var e=Object(s.d)(ee),t=Object(s.d)(Y);return n.createElement(n.Fragment,null,t.map((function(t){return t&&t.coordinates&&t.coordinates.map((function(a){return n.createElement(p.a,{key:t.pageid,position:[a.lat,a.lon],icon:n.createElement(d.b,{size:t.pageid===e.pageid?64:32,opacity:t.pageid===e.pageid?1:.8,className:pe.a.marker})})}))})))}var me=a(92),ge=a(93),fe=a.n(ge);function ve(){var e=Object(s.c)(),t=Object(s.d)(k),a=Object(s.d)(y).heading,r=Object(s.d)(w);Object(n.useEffect)((function(){e(b)}),[e]),Object(n.useEffect)((function(){var a,n,i;(null===t||void 0===t?void 0:t.length)>=2&&e((a=t[0],n=t[1],i=1e4,function(){var e=Object(L.a)(B.a.mark((function e(t,r){var c,o,l;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=r(),o=H(c),e.next=4,I.getPagesByGeoLocation(o,a,n,i);case 4:(l=e.sent)&&t(R({data:l}));case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()))}),[e,t]);var c=Object(n.useCallback)((function(t){t.zoom!==r&&e(h(t.zoom))}),[e,r]),u=i.a.createElement("div",{style:{transform:"rotate(".concat(a-90,"deg)")}},i.a.createElement(d.a,{size:24})),m=(null===t||void 0===t?void 0:t.length)>=2?t:[51.505,-.09];return i.a.createElement(i.a.Fragment,null,i.a.createElement(se,null),i.a.createElement(o.a,{center:m,zoom:r,onViewportChanged:c},i.a.createElement(l.a,{attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors, &copy; <a target="_blank" href="https://en.wikipedia.org">Wikipedia</a>, &copy; <a target="_blank" href="https://react-leaflet.js.org/">react-leaflet</a>, '+'<a target="_blank" href="https://github.com/kivle/msfs-map">MSFS-map</a> v'.concat(me.a),url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),i.a.createElement(de,null),t&&i.a.createElement(p.a,{position:t,icon:u,className:fe.a.plane})))}a(174);var he=function(){return i.a.createElement("div",{className:"App"},i.a.createElement(ve,null))},be=Object(m.a)({reducer:{map:E,wikipedia:te}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(175),a(3);window._store=be,c.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(s.a,{store:be},i.a.createElement(he,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},45:function(e,t,a){e.exports={main:"Wikipedia_main__4NWFl",title:"Wikipedia_title__QXPcz",text:"Wikipedia_text__1Xntm"}},46:function(e,t,a){e.exports={main:"Preferences_main__ok2ws",preference:"Preferences_preference__191Je"}},62:function(e,t,a){e.exports={main:"PlaneInfo_main__9z7SN",infoField:"PlaneInfo_infoField__3d4Nw"}},91:function(e,t,a){e.exports={marker:"Wikipedia_marker__RkQZr"}},92:function(e){e.exports=JSON.parse('{"a":"0.1.0"}')},93:function(e,t,a){e.exports={plane:"Map_plane__dttk2"}},94:function(e,t,a){e.exports=a(176)},99:function(e,t,a){}},[[94,1,2]]]);
//# sourceMappingURL=main.00824676.chunk.js.map